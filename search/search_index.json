{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Course website","text":""},{"location":"#course-teachers-and-authors","title":"Course teachers and authors","text":""},{"location":"#day-1","title":"Day 1","text":"<ul> <li>Christophe Dessimoz  </li> <li>Natasha Glover  </li> <li>Sina Majidian  </li> <li>Yannis Nevers  </li> </ul>"},{"location":"#day-2","title":"Day 2","text":"<ul> <li>Robert Waterhouse  </li> <li>Giulia Campli  </li> <li>Antonin Thi\u00e9baut  </li> </ul>"},{"location":"#day-3","title":"Day 3","text":"<ul> <li>Marc Robinson-Rechavi  </li> <li>Alessandro Brandulas Cammarata  </li> <li>Marina Bras\u00f3-Vives  </li> <li>Julien Wollbrett  </li> </ul>"},{"location":"#course-repository-and-website-authors","title":"Course repository and website authors","text":"<ul> <li>Antonin Thi\u00e9baut  </li> <li>Patricia Palagi  </li> </ul>"},{"location":"#material","title":"Material","text":"<ul> <li>This website</li> <li>Google doc (through mail)</li> </ul>"},{"location":"#learning-outcomes","title":"Learning outcomes","text":""},{"location":"#general-learning-outcomes","title":"General learning outcomes","text":"<p>After this course, you will be able to:</p> <ul> <li>Interpret phylogenetic trees and sequence alignments</li> <li>Infer orthologs and paralogs using graph- and tree-based methods</li> <li>Design and implement comparative analyses to interrogate genomics data, e.g. phylogenomics or gene family dynamics</li> </ul>"},{"location":"#learning-outcomes-explained","title":"Learning outcomes explained","text":"<p>To reach the general learning outcomes above, we have set a number of smaller learning outcomes. Each chapter starts with these smaller learning outcomes. Use these at the start of a chapter to get an idea what you will learn. Use them also at the end of a chapter to evaluate whether you have learned what you were expected to learn.</p>"},{"location":"#learning-experiences","title":"Learning experiences","text":"<p>To reach the learning outcomes we will use lectures and exercises. During exercises, you are free to discuss with other participants. During lectures, focus on the lecture only.</p>"},{"location":"#exercises","title":"Exercises","text":"<p>Each block has practical work involved. Some more than others. The practicals are subdivided into chapters, and we\u2019ll have a (short) discussion after each chapter. All answers to the practicals are incorporated, but they are hidden. Do the exercise first by yourself, before checking out the answer. If your answer is different from the answer in the practicals, try to figure out why they are different.</p>"},{"location":"#asking-questions","title":"Asking questions","text":"<p>During lectures, you are encouraged to ask questions if you have some!</p>"},{"location":"course_schedule/","title":"Course schedule","text":""},{"location":"course_schedule/#day-1-molecular-evolution-and-phylogenetics","title":"Day 1 - Molecular evolution and phylogenetics","text":"Timings Activities 9:00 - 9:30 Welcome, Introductions 9:30 - 10:00 Lecture: Overview, objectives, motivation, concept of orthologs, HOGs 10:00 - 10:45 Module 1: Genes, groups, and genomes in the OMA Browser 10:45 - 11:15 Coffee break 11:15 - 11:25 Go over results 11:25 - 11:30 Lecture: introduce OMAmer 11:30 - 11:55 Module 2: Fast placement with OMAmer 11:55 - 12:00 Go over results 12:00 - 12:10 Lecture: FastOMA 12:10 - 12:30 Module 3 part 1: FastOMA (launch it before lunch) 12:30 - 13:30 Lunch 13:30 - 14:00 Module 3 part 2: FastOMA 14:00 - 14:15 Go over results 14:15 - 14:30 Lecture: Gene trees and species trees 14:30 - 15:00 Coffee Break 15:00 - 16:00 Module 4: Building Species Trees 16:00 - 16:15 Go over results 16:15 - 16:45 OMA Clinic 16:45 - 17:00 Wrap-up &amp; Open Q&amp;A"},{"location":"course_schedule/#day-2-orthology-focused-arthropod-comparative-genomics","title":"Day 2 - Orthology-focused arthropod comparative genomics","text":"Timings Activities 09:00 - 10:15 Introductory Lectures - Orthology &amp; BUSCO 10:15 - 10:30 Introduction to the Hands-On &amp; Setting up Workspaces 10:30 - 11:00 Coffee Break 11:00 - 12:00 Practical Exercise 1 - BUSCO 12:00 - 13:00 Lunch Break 13:00 - 13:45 Practical Exercise 2 - OrthoDB &amp; Species Trees 13:45 - 14:30 Practical Exercise 3 - Gene-Tree-Species-Tree Reconciliation 14:30 - 15:00 Coffee Break 15:00 - 15:45 Case Studies Lectures 15:45 - 16:30 Practical Exercise 4 - Gene Family Ancestral State Reconstruction 16:30 - 17:00 Wrap-up &amp; Open Q&amp;A"},{"location":"course_schedule/#day-3-duplication-of-genes-and-genomes-expression","title":"Day 3 - Duplication of genes and genomes, expression","text":"Timings Activities 09:00 - 10:00 Lecture 1 - Function in model vs non-model organisms 10:00 - 10:30 Coffee Break 10:30 - 11:30 Practical Exercise 1 - Finding information about gene function at small scale 11:30 - 12:30 Lecture 2 - Finding function information at large scale 12:30 - 13:30 Lunch Break 13:30 - 14:45 Practical Exercise 2 - Finding information about gene function of a group of genes 14:45 - 15:15 Coffee Break 15:15 - 16:00 Lecture 3 - Gene and genome duplication 16:00 - 17:00 Practical Exercise 3 - Function of duplicated genes"},{"location":"precourse/","title":"Precourse preparations and Gitpod information","text":""},{"location":"precourse/#technical-requirements","title":"Technical requirements","text":"<p>Your computer should have an internet connection, and at least 8 GB RAM and 50 GB free disk space.</p>"},{"location":"precourse/#unix","title":"UNIX","text":"<p>As is stated in the course prerequisites at the announcement web page, we expect participants to have a basic understanding of working with the command line on UNIX-based systems. You can test your UNIX skills with a quiz here. If you don\u2019t have experience with UNIX command line, or if you\u2019re unsure whether you meet the prerequisites, follow our online UNIX tutorial. Before the course, make sure you can comfortably work with command line, R and git repository.</p>"},{"location":"precourse/#software","title":"Software","text":"<p>Most of the exercises will be run on Gitpod. Here are the steps to log in on Gitpod:</p> <ol> <li>Create a github or a gitlab account. Remember your email, your username, and your password!</li> </ol> <ol> <li>Open Gitpod and link your GitLab Account</li> </ol> <p>Authenticate your login with your gitlab/github credentials!</p> <ol> <li> <p>Open the desired repository in Gitpod: add <code>gitpod.io/#</code> at the beginning of the repository URL or\u2026</p> <ul> <li>Click here to directly open Day1 repo in Gitpod</li> <li>Click here to directly open Day2 repo in Gitpod</li> <li>Click here to directly open Day3 repo in Gitpod</li> </ul> </li> </ol>"},{"location":"precourse/#using-gitpod","title":"Using Gitpod","text":"<p>You can find the entire Gitpod documentation here.</p>"},{"location":"precourse/#reminders","title":"Reminders","text":"<ul> <li>Only files in the <code>/workspace</code> directory are kept between state transitions (when you stop and restart a workspace), so don\u2019t store files anywhere else otherwise they will be deleted when you stop the workspace</li> <li>Always stop workspace before leaving, otherwise it will keep running and be billed!<ul> <li>\u2018Menu\u2019 (the 3 horizontal bars top-left of the window)</li> <li>\u2018Gitpod: Stop workspace\u2019 (lower half of the menu)</li> </ul> </li> </ul>"},{"location":"precourse/#troubleshooting","title":"Troubleshooting","text":"<ul> <li>If you have a problem with your browser not showing everything, blocking pop-ups\u2026 click here for help</li> <li>If you have a problem when authenticating through gitlab or github, click here for help</li> <li>If the text you enter in the Gitpod terminal is invisible, try deactivating the GPU acceleration:<ul> <li>Click on the cog in the bottom-left</li> <li><code>Settings</code></li> <li>Type <code>gpu acceleration</code> in the search bar</li> <li>Set <code>Terminal \u203a Integrated: Gpu Acceleration</code> to <code>off</code></li> </ul> </li> </ul>"},{"location":"course_material/day1/1_general/","title":"General information and course material","text":""},{"location":"course_material/day1/1_general/#general-objectives","title":"General objectives","text":"<p>Interpret phylogenetic trees and alignments; general understanding of how trees are inferred; knowing the definition of orthology, paralogy and their subtypes; understanding the difference between pairwise and groupwise comparisons; ability to perform orthology inference through tree overlap method; ability to retrieve orthology information from the OMA database; ability to infer orthologs using the OMA standalone pipeline.</p>"},{"location":"course_material/day1/1_general/#course-material","title":"Course material","text":""},{"location":"course_material/day1/1_general/#lecture-overview-objectives-motivation-concept-of-orthologs-hogs","title":"Lecture: Overview, objectives, motivation, concept of orthologs, HOGs","text":"<p> Download the presentation</p>"},{"location":"course_material/day1/1_general/#module-1-genes-groups-and-genomes-in-the-oma-browser","title":"Module 1: Genes, groups, and genomes in the OMA Browser","text":"<p> Download the presentation</p>"},{"location":"course_material/day1/1_general/#module-2-fast-placement-with-omamer","title":"Module 2: Fast placement with OMAmer","text":"<p> Download the presentation</p>"},{"location":"course_material/day1/1_general/#module-3-fastoma","title":"Module 3: FastOMA","text":"<p> Download the presentation</p>"},{"location":"course_material/day1/1_general/#module-4-building-species-trees","title":"Module 4: Building Species Trees","text":"<p> Download the presentation</p>"},{"location":"course_material/day1/1_general/#course-gitlab-repository","title":"Course gitlab repository","text":"<p>The gitlab repository to run all the practicals is available at https://github.com/DessimozLab/SIBBiodiversityBioinformatics2023.</p> <p>Note</p> <p>Remember to open a Gitpod workspace before starting the practicals. Click here for more information on Gitpod workspace.</p>"},{"location":"course_material/day1/1_general/#working-directories","title":"Working directories","text":"<p>You can find the working directories of Modules 2, 3, and 4 in the following list:</p> <ul> <li>Module 2 working directory</li> <li>Module 3 working directory</li> <li>Module 4 working directory</li> </ul>"},{"location":"course_material/day1/1_general/#exercises-ouputs","title":"Exercises ouputs","text":"<p>You can find the expected outputs of Modules 2, 3, and 4 in the following list:</p> <ul> <li>Module 2 expected outputs</li> <li>Module 3 expected outputs</li> <li>Module 4 expected outputs</li> </ul>"},{"location":"course_material/day1/2_exercices/","title":"Links to the OMA Academy modules","text":""},{"location":"course_material/day1/2_exercices/#aim","title":"Aim","text":"<p>Become more familiar with orthology, phylogenies, and comparative genomics.</p>"},{"location":"course_material/day1/2_exercices/#learning-outcomes","title":"Learning outcomes","text":"<ul> <li>Define orthology, paralogy and their subtypes</li> <li>Retrieve orthology information from the OMA database</li> <li>Map sequences quickly to their Hierarchical Orthologous Groups</li> <li>Infer orthologs on custom genomes using the FastOMA pipeline</li> <li>Construct and interpret phylogenetic species trees using OMA data</li> </ul>"},{"location":"course_material/day1/2_exercices/#exercises","title":"Exercises","text":"<p>The exercises were implemented as modules in the OMA Academy. OMA Academy is an e-learning website with a suite of self-learning modules centered around comparative genomics and phylogenetics. The modules are specifically designed to help computational biologists use OMA, a method and database for inferring orthologs. Each module is stand-alone, with a basic introduction and a series of exercises with hints and answers.</p> <p>Here are the links to directly access the different modules:</p> <ul> <li>Module 1</li> <li>Module 2</li> <li>Module 3</li> <li>Module 4</li> </ul>"},{"location":"course_material/day2/1_general/","title":"General information and course material","text":""},{"location":"course_material/day2/1_general/#general-objectives","title":"General objectives","text":"<p>Understand the principles of graph-based orthology delineation using OrthoDB as an example; learn how to browse and programmatically query OrthoDB; learn how to use BUSCO to assess genomics data quality; learn how to formulate comparative genomics questions, develop and apply approaches to address them (with a focus on using orthology data), and then critically interpret them, through case studies from arthropods.</p>"},{"location":"course_material/day2/1_general/#course-material","title":"Course material","text":""},{"location":"course_material/day2/1_general/#presentation","title":"Presentation","text":"<p> Download the presentation</p>"},{"location":"course_material/day2/1_general/#case-study-moulting-genes-across-arthropod-diversity","title":"Case study: Moulting genes across arthropod diversity","text":"<p> Download the presentation</p>"},{"location":"course_material/day2/1_general/#case-study-diving-into-the-drosophila-immune-response-with-orthology-and-expression-data","title":"Case study: Diving into the Drosophila immune response with orthology and expression data","text":"<p> Download the presentation</p>"},{"location":"course_material/day2/1_general/#course-gitlab-repository","title":"Course gitlab repository","text":"<p>The gitlab repository to run all the practicals is available at https://gitlab.com/evogenlab/teaching-repos/biodivinfo.</p> <p>Note</p> <p>Remember to open a Gitpod workspace before starting the practicals. Click here for more information on Gitpod workspace.</p>"},{"location":"course_material/day2/1_general/#intermediate-result-files","title":"Intermediate result files","text":"<p>If you need intermediate result files, follow this procedure on how to get them.</p>"},{"location":"course_material/day2/2_software/","title":"Software and resources","text":""},{"location":"course_material/day2/2_software/#software","title":"Software","text":"<p>These links are provided for information only, they are not needed now for the practical but if you finish any exercises early you may want to investigate the tools/resources a little further by checking out their websites, user guides, and/or their main publications.</p> <p>BUSCO - Benchmarking Universal Single-Copy Orthologues</p> <ul> <li>Website</li> <li>Publication</li> <li>Userguide</li> </ul> <p>CAFE - computational analysis of gene family evolution</p> <ul> <li>Website</li> <li>Publication</li> <li>Userguide</li> </ul> <p>iTOL - online phylogenetic tree viewer</p> <ul> <li>Website</li> <li>Publication</li> <li>Userguide</li> </ul> <p>JalView: for multiple sequence alignment editing, visualisation and analysis</p> <ul> <li>Website</li> <li>Publication</li> </ul> <p>MAFFT - multiple sequence alignment tool</p> <ul> <li>Website</li> <li>Publication</li> <li>Userguide</li> </ul> <p>OrthoDB - orthology database</p> <ul> <li>Website</li> <li>Publication</li> <li>Userguide</li> </ul> <p>RAxML - maximum likelihood phylogenies</p> <ul> <li>Website</li> <li>Publication</li> <li>Userguide</li> </ul> <p>Treerecs - tree reconciliation software</p> <ul> <li>Website</li> <li>Publication</li> <li>Userguide</li> </ul> <p>TrimAl - alignment filtering tool</p> <ul> <li>Website</li> <li>Publication</li> <li>Userguide</li> </ul>"},{"location":"course_material/day2/2_software/#r-and-packages","title":"R and packages","text":"<p>R</p> <ul> <li>Website</li> <li>There are no publication for R itself but you should still cite it</li> <li>Userguide</li> </ul> <p>Chronos function of the ape package</p> <ul> <li>Website/Userguide</li> <li>Publication</li> </ul>"},{"location":"course_material/day2/2_software/#folder-with-intermediate-result-files","title":"Folder with intermediate result files","text":"<p>If you get stuck, you can find all intermediate results files in the virtual gitpod workspace <code>/workspace/biodivinfo/data/</code>. Simply fetch the correct output files in order to continue with the next steps of the practical:</p> <ul> <li> <p>Use the copy <code>cp</code> command from the terminal in gitpod, e.g.: <code>cp /workspace/biodivinfo/data/the_file_you_want_to_copy path/to/destination/</code></p> </li> <li> <p>If the files are zipped (i.e. if the name ends with <code>.zip</code>), you can uncompress them with: <code>unzip /path/to/file.zip</code></p> </li> </ul>"},{"location":"course_material/day2/3_busco/","title":"BUSCO - the what, why, and how!","text":""},{"location":"course_material/day2/3_busco/#aim","title":"Aim","text":"<p>Use BUSCO to assess the quality of different types of genomic data.</p>"},{"location":"course_material/day2/3_busco/#learning-outcomes","title":"Learning outcomes","text":"<ul> <li>What are the different BUSCO modes and when should you use them?</li> <li>What are the BUSCO outputs and where to find them?</li> </ul>"},{"location":"course_material/day2/3_busco/#introduction","title":"Introduction","text":"<p>In 2013 I was working on producing genome assemblies for 16 Anopheles mosquitoes, back then we only had short-read technologies and we needed to find a way to assess the quality of the genomes we were producing. I therefore started developing what eventually became BUSCO, now one of the most widely used tools in genomics for assessing the quality of genome assemblies and annotations in terms of gene completeness.</p>"},{"location":"course_material/day2/3_busco/#assessing-genome-assemblies-for-completeness","title":"Assessing genome assemblies for completeness","text":"<p>Before we download any genomics data, let\u2019s create a working directory for this exercise, starting by opening a terminal on the Workspace if you\u2019ve not already got one open. Then, from the <code>/workspace/biodivinfo/</code> directory, create a new directory (<code>mkdir</code>) and navigate into the new directory (<code>cd</code>):</p> <pre><code>cd /workspace/biodivinfo/\nmkdir Session1\ncd Session1/\n</code></pre> <p>Now we can fetch some genome data that we wish to assess. We will work on a small genome so that it does not take too long to run the analyses, hence I have chosen Saccharomyces jurei, a newly discovered fungal species with a small genome of 12 Mbps (GenBank assembly GCA_900290405.1) that can be found on the NCBI.</p> <p>The summary statistics are already provided by the NCBI, but not the BUSCO evaluations:</p> <p>Questions:</p> <ul> <li>What is the \u201cScaffold N50\u201d and what does it mean?</li> <li>What is the \u201cScaffold L50\u201d and what does it mean?</li> </ul> Answer <p>The N50 is the shortest contig length that needs to be included for covering 50% of the genome. The L50 is the count of smallest number of contigs whose length sum makes up half of a genome size. More information here.</p> <p>We will use the <code>curl</code> command and the NCBI Datasets framework to fetch the genome assembly in FASTA format and then unzip the downloaded file:</p> <pre><code>curl -OJX GET \"https://api.ncbi.nlm.nih.gov/datasets/v2alpha/genome/accession/GCA_900290405.1/download?include_annotation_type=GENOME_FASTA&amp;filename=GCA_900290405.1.zip\" -H \"Accept: application/zip\"\nunzip GCA_900290405.1.zip\n</code></pre> <p>We will take a look at the first few lines of the FASTA file: <pre><code>head ncbi_dataset/data/GCA_900290405.1/GCA_900290405.1_SacJureiUoM1_genomic.fna\n</code></pre></p> <p>Now we have the genome, we can run BUSCO assessments in the genome mode to quantify gene completeness of this genome assembly.</p> <p>The four main required input options for us therefore are:</p> <ul> <li><code>-i ncbi_dataset/data/GCA_900290405.1/GCA_900290405.1_SacJureiUoM1_genomic.fna</code></li> <li><code>-o SacJurei</code></li> <li><code>-m genome</code></li> <li><code>-l eukaryota_odb10</code></li> </ul> <p>We will also specify the job to use 4 CPUs in order to speed up the task: <code>-c 4</code></p> <p>The whole command will thus be: <pre><code>busco -i ncbi_dataset/data/GCA_900290405.1/GCA_900290405.1_SacJureiUoM1_genomic.fna -o SacJurei -m genome -l eukaryota_odb10 -c 4\n</code></pre></p> <p>On the terminal you can see which steps BUSCO is executing:</p> <ul> <li>Configuration</li> <li>Dataset download</li> <li>Metaeuk: this is the default \u201cgene finding\u201d approach</li> </ul> <p>Question: What other \u201cgene finding\u201d approaches are possible to use with BUSCO?</p> Answer <p>2 other gene finding approaches are implemented in BUSCO: Augustus (<code>--augustus</code> flag) and Miniprot (<code>--miniprot</code> flag).</p> <p>Which BUSCO lineage to choose?</p> <p>We used the \u201ceukaryota\u201d dataset:</p> <ul> <li>eukaryota_odb10: 255 BUSCOs<ul> <li>fungi_odb10: 758 BUSCOs<ul> <li>ascomycota_odb10: 1706 BUSCOs<ul> <li>saccharomycetes_odb10: 2137 BUSCOs</li> </ul> </li> </ul> </li> </ul> </li> </ul> <p>Question: Why would you want to use a more specific or a less specific lineage dataset for your BUSCO evaluations?</p> Answer <p>Testing a genome with a more specific lineage dataset will make BUSCO look for clade-specific genes and thus will find more genes. Testing with a less specific lineage dataset will make BUSCO look for genes that are present in a lot of species, thus restricting the number of genes. These genes usually have key functions such as transcription, translation\u2026</p> <p>The analysis continues with the following steps being printed to the terminal:</p> <ul> <li>Once metaeuk (first round) is completed, then</li> <li>The hmmsearch step follows</li> </ul> <p>Question: What is the hmmsearch step doing?</p> Answer <p>It searches for sequence homologs between the BUSCO database and the genome to evaluate.</p> <p>The analysis continues with the following steps being printed to the terminal:</p> <ul> <li>The extraction of missing and fragmented buscos</li> <li>A second round of metaeuk predictions</li> <li>Then a second round of hmmsearch follows</li> <li>To finally give the results</li> </ul> <p>The analysis should take about 8 minutes to complete.</p> <p>If BUSCO failed, you can get the file from the folder with data files for the practical instead</p> <pre><code>cp /workspace/biodivinfo/data/Session1/SacJurei.zip .\nunzip SacJurei.zip\n</code></pre> <p>Let\u2019s explore the results of a typical genome assembly assessment run: <pre><code>ls -l SacJurei/\n</code></pre></p> <p>Here\u2019s a short summary of the files created by BUSCO:</p> <ul> <li>logs: useful if something went wrong</li> <li>short_summary.specific.eukaryota_odb10.SacJurei.txt: open the file in the text editor (pink, explorer)<ul> <li>Indicates the lineage dataset that was used (blue)</li> <li>Summarises the main results (green)</li> <li>Provides some assembly statistics (yellow)</li> <li>Lists the versions of all the tools used during this run (orange)</li> </ul> </li> </ul> <ul> <li>short_summary.specific.eukaryota_odb10.SacJurei.json: JSON version of the previous file</li> <li> <p>run_eukaryota_odb10: folder with the full results from the run</p> <p> </p> <ul> <li>busco_sequences:: PROTEIN and DNA sequences provided<ul> <li>fragmented_busco_sequences</li> <li>multi_copy_busco_sequences</li> <li>single_copy_busco_sequences</li> </ul> </li> <li>full_table.tsv: details of status (Complete, Duplicated, Fragmented, or Missing), genomic locations, scores, and lengths of all searched BUSCOs</li> </ul> <p> </p> <ul> <li>hmmer_output: searching predicted proteins against BUSCO profiles<ul> <li>initial_run_results</li> <li>Rerun_results</li> </ul> </li> <li>metaeuk_output: the gene prediction results<ul> <li>combined_nucl_seqs.fas</li> <li>combined_pred_proteins.fas</li> <li>initial_results</li> <li>refseq_db_rerun.faa</li> <li>Rerun_results</li> </ul> </li> <li>missing_busco_list.tsv: the BUSCOs that were never found</li> </ul> </li> </ul> <p>Let\u2019s plot the results of a typical genome assembly assessment run. BUSCO provides R scripts to produce basic plots that summarise the results. Normally you would want to summarise the results from several assessments, e.g. the same genome with different lineage datasets, or different versions of your genome assembly build with different workflows/parameters, or the assessments of the genome assemblies of several species side-by-side.</p> <p>Therefore we need to copy our short summary file into a new folder:</p> <pre><code>mkdir BUSCO_summaries\ncp SacJurei/short_summary.specific.eukaryota_odb10.SacJurei.txt BUSCO_summaries/\n</code></pre> <p>Note</p> <p>Make sure you are still in the <code>Session1</code> directory! You can use the command <code>pwd</code> to check where you are located.</p> <p>Run the python script to plot the summary: <pre><code>python3 /workspace/mambaforge/envs/course/bin/generate_plot.py -wd BUSCO_summaries\n</code></pre></p> <p>Note</p> <p>This command will produce some warnings and errors but you can ignore them - they are caused by an argument deprecation in the <code>ggplot2</code> R package.</p> <p> </p> <p>Open the resulting plot file (<code>busco_figure.png</code>) using the explorer (left panel of the window). You can zoom in/out by using Ctrl + scroll up/down (mousewheel) on the figure.</p> <p>Let\u2019s check some of these apparently missing BUSCOs:</p> <p>Search OrthoDB v10 for the missing BUSCO, 1038775at2759:</p> <p>This gene is the Eukaryotic translation initiation factor 3 subunit F. It has orthologues in 91% of eukaryotes at OrthoDB v10. Of these, it is single-copy in 89%.</p> <p>Checking other Saccharomyces species at OrthoDB in the same orthogroup, 1038775at2759, reveals that only one species of Saccharomycetaceae seems to have an orthologue of Eukaryotic translation initiation factor 3 subunit F.</p> <p>This is despite the fact that OrthoDB v10 contains 31 species of Saccharomycetaceae, strongly suggesting a real evolutionary loss of this otherwise highly conserved gene.</p> <p>This has been recognised in the literature, and indeed two of the other missing BUSCOs are the group of Subunit H orthologues, 976469at2759, and the group of Subunit M orthologues, 679771at2759.</p>"},{"location":"course_material/day2/3_busco/#assessing-genome-annotations-for-completeness","title":"Assessing genome annotations for completeness","text":"<p>Next we will run an assessment of an annotated protein set, i.e. \u201cproteins\u201d mode.</p> <p>Question: What is the difference between \u201cproteins\u201d mode and \u201ctranscriptome\u201d mode?</p> Answer <p>The \u201cproteins\u201d mode assesses a gene set, while the \u201ctranscriptome\u201d mode assesses assembled transcripts, which requires either tBLASTn (for prokaryotes) or Metaeuk (for eukaryotes).</p> <p>For this exercise we will look at the human body louse, Pediculus humanus corporis (GenBank assembly GCF_000006295.1) that can be found on the NCBI. The NCBI reports a total of 10\u2018773 protein-coding genes, which is a somewhat small number of genes compared to many other insect genomes.</p> <p>We will use the <code>curl</code> command and the NCBI Datasets framework to fetch the genome annotations file in FASTA format and then unzip the downloaded file:</p> <pre><code>curl -OJX GET \"https://api.ncbi.nlm.nih.gov/datasets/v2alpha/genome/accession/GCF_000006295.1/download?include_annotation_type=PROT_FASTA&amp;filename=GCF_000006295.1.zip\" -H \"Accept: application/zip\"\nunzip GCF_000006295.1.zip\n</code></pre> <p>Hint</p> <p>If the prompt asks if you wish to replace some files, just say yes, type <code>A</code> and then enter return (this is because we previously downloaded a genome from NCBI).</p> <p>The four main required input options for us therefore are:</p> <ul> <li><code>-i ncbi_dataset/data/GCF_000006295.1/protein.faa</code></li> <li><code>-o Pediculus</code></li> <li><code>-m proteins</code></li> <li><code>-l arthropoda_odb10</code></li> </ul> <p>We will also specify the job to use 4 CPUs in order to speed up the task: <code>-c 4</code></p> <p>The whole command will thus be: <pre><code>busco -i ncbi_dataset/data/GCF_000006295.1/protein.faa -o Pediculus -m proteins -l arthropoda_odb10 -c 4\n</code></pre></p> <p>The job starts by configuring the environment, then fetching the \u201carthropoda_odb10\u201d lineage dataset, and then launching the hmmsearch jobs:</p> <p>Question: Why does BUSCO this time go directly into the hmmsearch steps and not start with the gene prediction (metaeuk) steps?</p> Answer <p>The genes are already annotated, hence there is no need to predict them.</p> <p>When the 1013 searches are complete, the final results are displayed:</p> <p>Question: Despite the \u201clow\u201d number of genes in this genome, what can we say about the completeness of this annotation set?</p> Answer <p>This annotation set seems very complete, with a lot of single-copy BUSCOs (96.4%) and very few duplicated (0.3%) or missing (0.8%) BUSCOs.</p> <p>If BUSCO failed, you can get the file from the folder with data files for the practical instead</p> <pre><code>cp /workspace/biodivinfo/data/Session1/Pediculus.zip .\nunzip Pediculus.zip\n</code></pre> <p>Use the explorer to see the output files and folders. Although they are similar to when we ran a genome assembly assessment, note this time there are no \u201cmetaeuk\u201d results folders, only the sequences and the hmmer_output, along with the table, list and summary files.</p> <p>If you want, you can once again plot the results of the BUSCO run: <pre><code>cp Pediculus/short_summary.specific.arthropoda_odb10.Pediculus.txt BUSCO_summaries/\npython3 /workspace/mambaforge/envs/course/bin/generate_plot.py -wd BUSCO_summaries\n</code></pre></p> <p>Note</p> <p>This will produce a single plot containing the results of both BUSCO runs, SacJurei and Pediculus. Keep in mind that these runs were performed with different modes (genome vs proteins), hence represent different results!</p> <p>There are only 8 \u201cmissing\u201d BUSCOs from this annotation set. Searching OrthoDB v10 for the first one, 127998at6656, shows it to be Ribosomal protein L7A/L8, an otherwise highly-conserved gene (168 of 172 arthropods).</p> <p>I thought that this was probably unlikely to be a real missing gene, so I searched the genome using the Drosophila melanogaster orthologue and I found a good hit in the Pediculus genome assembly, in a region where no gene was annotated! I therefore used the available transcriptomics data (blue) to create a manual annotation for this gene (green), so one day when manual annotations make their way into official gene sets at the NCBI this gene will no longer appear as \u201cmissing\u201d when performing an assessment of the annotated gene set.</p> <p>A sequence alignment with orthologues from other species convinces me that I have managed to correctly annotate the complete gene in Pediculus.</p> <p>A cautionary note about alternative transcripts</p> <ul> <li>We used the Pediculus annotation from the NCBI</li> <li>We did no pre-filtering of this annotation set to select just one protein representative per gene</li> </ul> <p>Question: Why would we normally want to select just one protein representative per gene when running an assessment of an annotation set?</p> Answer <p>Keeping all the isoforms of a gene will artificially increase the number of Duplicated BUSCOs and lead to a biased assessment of the annotation set.</p> <p>We can actually count the number of proteins in the Pediculus protein FASTA file to see if this affects our analysis: <pre><code>grep -c '&gt;' ncbi_dataset/data/GCF_000006295.1/protein.faa\n</code></pre></p> <p>This tells us there are 10\u2018775 proteins in this file, but remember that the NCBI page indicated that there were 10\u2018773 protein-coding genes in this annotation set:</p> <ul> <li>In this case therefore there is at least one gene, possibly two genes, with alternative transcripts annotated</li> <li>So here the impact on our analysis will be negligible if anything</li> </ul> <p>The NCBI are working on providing \u201creference\u201d annotation sets that contain one selected representative protein per gene. For now though you would have to perform the filtering yourself if you wanted to ensure the \u201cduplication\u201d values produced by BUSCO make sense in terms of reporting real gene duplications rather than alternative protein products of a single gene.</p>"},{"location":"course_material/day2/4_homology/","title":"Homology, Orthology, & Paralogy","text":""},{"location":"course_material/day2/4_homology/#aim","title":"Aim","text":"<p>Build a molecular species phylogeny using orthologues identified from an orthology database.</p>"},{"location":"course_material/day2/4_homology/#learning-outcomes","title":"Learning outcomes","text":"<ul> <li>What is needed as input to build a molecular species phylogeny?</li> <li>How do we have confidence in such a species tree?</li> </ul>"},{"location":"course_material/day2/4_homology/#collecting-input-data-from-an-orthology-database","title":"Collecting input data from an orthology database","text":"<p>There are many publicly accessible orthology databases, or tools that can be used to delineate orthology with your own datasets. Today, we will use data from OrthoDB. OrthoDB is part of the SwissOrthology resource.</p> <p>From your browser, search for orthodb.org or go to https://www.orthodb.org/. We will use the OrthoDB website to select our species/clade of interest and query the database to retrieve orthologous groups that we can use to build a species tree.</p> OrthoDB v11 homepage <p>Because the beetles are wonderful, we will use them as the example group for exploring the orthology data and building our molecular species tree. We will therefore used the  navigation tool of OrthoDB to narrow our search to available beetle species (Coleoptera): Eukaryota \u21d2 Metazoa \u21d2 Arthropoda \u21d2 Hexapoda \u21d2 Insecta \u21d2 Holometabola \u21d2 Coleoptera.</p> <p>The <code>Search at:</code> and <code>Species to display:</code> boxes should be automatically updated now to show \u201cColeoptera\u201d and \u201call 15 selected\u201d. Click <code>Submit</code> with no search terms to first retrieve all orthologous groups delineated across these 15 species of beetles.</p> <p>For the orthologous groups returned by the query, summary information is displayed:</p> <ul> <li>Orthologous group names/descriptions (if available)</li> <li>Counts of genes and species per orthologous group</li> </ul> <p>Question: How many groups in total are returned? What kinds of orthologous groups would we need to find if we want to build a species tree, and why?</p> Answer <p>14753 groups are returned. However, it is best to use single-copy orthologues to build a species tree, because they easily allow to calculate the exact evolutionary distance between sequences. Using multi-copy orthologues drastically complicates things as you cannot be sure of the homology relationships between all the genes (orthology vs paralogy).</p> <p>We can use the <code>Advanced</code> navigation tool of OrthoDB to narrow our search for orthologous groups that will be useful for building a species phylogeny. Using the \u201cPhyloprofile\u201d filter we can ask the query to return only orthologous groups that are \u201cPresent in all species\u201d and that are \u201cSingle-copy in all species\u201d. Click <code>Submit</code> with no search terms to retrieve all orthologous groups delineated across these 15 species of beetle, now with the phyloprofile filtered set.</p> <p>Note</p> <p>Direct URL in case the search with filters failed for you.</p> Results of the filtered query <p>Question: Did the filtering work - how do you know? How many groups in total are now returned? Why are there so few groups compared to the last query that returned all orthologous 14\u2018753 groups?</p> Answer <p>The filtering worked: we now have only 1225 groups, all composed of 1 gene per species. The previous query returned more results because a lot of groups contained genes in several but not all species, and these groups were filtered out during this search.</p> <p>Explore some specific results of your query, e.g. the ones for group 10000at7041 described as \u201cphosphatidylinositol 4-kinase beta\u201d:</p> <ul> <li>The Group hierarchy view allows navigating back up the tree of life to the metazoan last common ancestor</li> </ul> <ul> <li>Functional descriptions list Gene Ontology (GO) terms and InterPro domains that have been mapped to genes belonging to this orthologous group. They provide clues as to the likely function of all genes in the orthologous group</li> </ul> <ul> <li>Evolutionary descriptions summarise the group\u2019s phyletic profile, its relative rate of protein sequence divergence, and the \u201caverage\u201d gene architecture (structure in terms of introns and exons and total length in amino acids)</li> </ul> <p>Expand the Orthologs by organism table to view members of this orthologous group:</p> <p>Questions:</p> <ul> <li>What is the average length (AAs) of these proteins? Are there any substantially longer or shorter proteins than the average?</li> <li>Why might some be rather different from the average? What impacts could this have when it comes to using these sequences for building a phylogeny?</li> </ul> Answer <p>The average length of these proteins is ~930 AAs. There are no substantially longer proteins, but we can notice much shorter proteins (349 AAs, 613 AAs\u2026) that are displayed with one or two exclamation marks <code>!</code> depending on the length difference. These short proteins might be real but more likely, they indicate an annotation problem (for example a case of automatic annotation that did not pick-up the full length protein). These proteins can severely impact species tree creation because they will cause a bias in the multiple alignment step.</p> <p>Additional information about each gene can be viewed by clicking on the chevron buttons <code>&gt;</code> or <code>&gt;&gt;</code>, e.g. for the Tribolium castaneum orthologue:</p> <p>Before we download any orthology data, let\u2019s create a working directory for this exercise, starting by opening a terminal on the Workspace if you\u2019ve not already got one open. Then, from the <code>/workspace/biodivinfo/</code> directory, create a new directory (<code>mkdir</code>) and navigate into the new directory (<code>cd</code>):</p> <pre><code>cd /workspace/biodivinfo/\nmkdir Session2\ncd Session2/\n</code></pre> <p>To build a phylogeny we need to download the sequences: on the top right of each orthologous group view you can access the protein sequences using \u201cView Fasta\u201d.</p> <p>A new tab will open displaying the protein sequences, copy the URL of the page so we can use it to download the sequences directly in the next step.</p> <p>Now fetch the fasta formatted sequences from OrthoDB from the command line using <code>curl</code>, give the downloaded fasta data a filename (-o) using the orthologous group ID \u201c10000at7041.fasta\u201d and make sure that the URL is placed inside quotes: <pre><code>curl -o 10000at7041.fasta \"https://data.orthodb.org/v11/fasta?id=10000at7041&amp;species=7041\"\n</code></pre></p> <p>If fetching from OrthoDB failed, you can get the file from the folder with data files for the practical instead</p> <pre><code>cp /workspace/biodivinfo/data/Session2/10000at7041.fasta .\n</code></pre> <p>Use the file explorer on the Workspace to view the downloaded fasta file.</p> <p>We need to replace the colon \u201c_0:\u201d in the protein identifiers with an underscore \u201c_0_\u201d because some downstream tools do not accept colons in identifiers. We will perform such replacement using the command line function <code>sed</code>: <pre><code>sed -i 's/_0:/_0_/g' 10000at7041.fasta\n</code></pre></p> Note how there are now no longer any colons in the identifiers"},{"location":"course_material/day2/4_homology/#building-a-tree-from-single-copy-orthologues","title":"Building a tree from single-copy orthologues","text":"<p>There are many different software tools available for sequence alignment and phylogenetics, the logic however remains basically the same no matter the software, we need to:</p> <ul> <li>Align all the protein sequences as a multiple sequence alignment: we use MAFFT</li> <li>Filter/trim the alignment to keep only well-aligned regions: we use TrimAl</li> <li>Use the filtered alignment to build a molecular phylogeny: we use RAxML</li> </ul>"},{"location":"course_material/day2/4_homology/#multiple-sequence-alignment-using-mafft","title":"Multiple sequence alignment using MAFFT","text":"<p>The basic command for running MAFFT is:</p> <p>We can run MAFFT in the \u201cquiet\u201d mode to avoid progress reports (<code>--quiet</code>). We can proceed to build the alignment from the command line as follows, naming the output alignment file appropriately by adding <code>.aln.</code> to the output filename: <pre><code>mafft --quiet --auto 10000at7041.fasta &gt; 10000at7041.aln.fasta\n</code></pre></p> <p>Use the file explorer on the Workspace to open the multiple sequence alignment file.</p> <p>If MAFFT failed, you can get the file from the folder instead</p> <pre><code>cp /workspace/biodivinfo/data/Session2/10000at7041.aln.fasta .\n</code></pre> <p>You might otherwise use your favourite alignment viewer (e.g. JalView) for a more colourful and meaningful visualisation. To download the file from the Workspace, find the file in the explorer, right-click on the file, and select <code>Download</code>.</p> <p>Here are two examples of the JalView visualisation:</p> First ~200 columns of the alignment Last ~200 columns of the alignment <p>Questions:</p> <ul> <li>From the two visualisations above showing the start and then the end of the alignment - which end seems more complete and well-aligned?</li> <li>What do you think an alignment region would need to have in order to be most useful for reconstructing the phylogeny, and why?</li> </ul> Answer <p>The end of the alignment seems more complete and well-aligned. To reconstruct the phylogeny, an alignment region should not have too many mutations: if there are no common regions between the proteins, they will be impossible to align to each other and it will impossible to build the phylogeny. On the other hand, an alignment without mutations should also be avoided because it contains no signal to discriminate between species.</p>"},{"location":"course_material/day2/4_homology/#filtertrim-using-trimal","title":"Filter/trim using TrimAl","text":"<p>We could manually go through the multiple sequence alignment and select regions that we think would be the best to use for building the phylogeny - but this is very subjective and not at all reproducible. Therefore there are several tools designed to help select \u201cuseful\u201d regions from multiple sequence alignments and extract them to use for subsequent tree building steps.</p> <p>The basic command for running TrimAl is:</p> <p>TrimAl has many parameters that one can tune depending on your input dataset, as well as a few \u201cdefault\u201d options such as:</p> <ul> <li><code>-nogaps</code>: remove all positions with gaps in the alignment</li> <li><code>-strict</code>: use automatic selection on \u201cstrict\u201d mode</li> <li><code>-automated1</code>: use a heuristic selection of the automatic method based on similarity statistics</li> </ul> <p>Here we will use the <code>-automated1</code> option, a heuristic approach that selects the best automatic method to trim a given alignment, and is optimised for trimming alignments that will be analysed by Maximum Likelihood phylogenetic analyses. The output filename we will label with <code>.trm.</code> i.e. after trimming has been performed. We will also ask TrimAl to print out an HTML output to visualise the regions selected and rejected from the input full alignment: <pre><code>trimal -in 10000at7041.aln.fasta -out 10000at7041.aln.trm.fasta -automated1 -htmlout 10000at7041.aln.trm.html\n</code></pre></p> <p>You can now download (same as how you downloaded the alignment before trimming) and open 10000at7041.aln.trm.html (e.g. Firefox or another browser) to view the results.</p> <p>If trimAl failed, you can get the files from the folder instead</p> <pre><code>cp /workspace/biodivinfo/data/Session2/10000at7041.aln.trm.fasta .\ncp /workspace/biodivinfo/data/Session2/10000at7041.aln.trm.html .\n</code></pre> <p>TrimAl\u2019s HTML output shows the regions selected (<code>Selected Cols:</code> highlighted in grey) and the regions rejected during the filtering process:</p>"},{"location":"course_material/day2/4_homology/#phylogeny-building-using-raxml","title":"Phylogeny building using RAxML","text":"<p>We will now use the filtered alignment as input to RAxML to build a Maximum Likelihood phylogeny. Because we have single-copy orthologues - one from each of our 15 beetle species - we can have some expectation that this gene tree would represent the species tree.</p> <p>For reference, species names and their OrthoDB taxonomic identifiers:</p> OrthoDB taxonomic identifiers Species name Beautiful beetles 110193_0 Nicrophorus vespilloides 115357_0 Harmonia axyridis 116153_0 Aethina tumida 1629725_0 Oryctes borbonicus 166361_0 Onthophagus taurus 217634_0 Anoplophora glabripennis 224129_0 Agrilus planipennis 41139_0 Coccinella septempunctata 41895_0 Tribolium madens 50390_0 Diabrotica virgifera 7048_0 Sitophilus oryzae 7054_0 Photinus pyralis 7070_0 Tribolium castaneum 7539_0 Leptinotarsa decemlineata 77166_0 Dendroctonus ponderosae <p>RAxML has many options! View the summary of parameters/options using the <code>-h</code> flag, for the full explanations you\u2019ll need to check out the RAxML manual later: <pre><code>raxmlHPC-SSE3 -h | more\n</code></pre></p> <p>The three main required input options are:</p> <ul> <li><code>-s sequenceFileName</code>: your filtered alignment file</li> <li><code>-n outputFileName</code>: the name you want to give the output files</li> <li><code>-m substitutionModel</code>: the substitution model you want RAxML to use</li> </ul> <p>Phylogeny estimation using protein sequences requires the selection of a protein substitution model. Divergence among sequences can be modelled with a matrix that describes probabilities of amino acid substitutions (mutations that cause one amino acid to be replaced by another). This corresponds to a model of evolution in which amino acids mutate randomly and independently from one another but according to some predefined probabilities depending on the properties of the amino acid itself.</p> <p>We will use the JTT (Jones-Taylor-Thornton) with the GAMMA model of rate heterogeneity: <code>PROTGAMMAJTT</code>. For speed in the class we will also specify that RAxML should use its rapid bootstrap algorithm to conduct a rapid bootstrap analysis and search for the best-scoring ML tree in one single programme run: <code>-f a</code>, we also need to indicate how many bootstraps RAxML should perform: <code>-N 10</code> (normally many more, but for the class we will perform only 10 samples). For reproducibility of the optimisation steps, RAxML additionally requires us to define the random starting seed for parsimony e.g. <code>-p 12345</code> and for the subsequent ML search e.g. <code>-x 12345</code>.</p> <p>Launch RAxML with the options defined for a rapid bootstrap &amp; ML analysis: <pre><code>raxmlHPC-SSE3 -s 10000at7041.aln.trm.fasta -f a -N 10 -p 12345 -x 12345 -m PROTGAMMAJTT -n 10000at7041\n</code></pre></p> <p>RAxML should take less than 2 minutes to estimate the phylogeny with 10 bootstrap samples, printing the progress log to the terminal.</p> <p>Question: What is \u201cbootstrap analysis\u201d and why would we be interested in running it?</p> Answer <p>Bootstrapping is a type of test that uses random sampling with replacement (resampling methods) - it uses sampling with replacement to assess the reliability of sequence-based phylogenies. Bootstrap values in a phylogenetic tree indicate how many times the same branch is observed when repeating the generation of a phylogenetic tree on a resampled set of data and thus give information about the stability of the tree structure (i.e. the branching order). In bootstrap resampling, we generate artificial sequences by randomly sampling sites of the original sequences with replacement to produce a different composition of the data with the same sequence length as the original alignment.</p> <p>If RAxML failed, you can get the files from the folder instead</p> <pre><code>cp /workspace/biodivinfo/data/Session2/RAxML_bestTree.10000at7041 .\ncp /workspace/biodivinfo/data/Session2/RAxML_bipartitions.10000at7041 .\ncp /workspace/biodivinfo/data/Session2/RAxML_bipartitionsBranchLabels.10000at7041 .\ncp /workspace/biodivinfo/data/Session2/RAxML_bootstrap.10000at7041 .\ncp /workspace/biodivinfo/data/Session2/RAxML_info.10000at7041 .\n</code></pre> <p>RAxML output:</p> <ul> <li><code>_bestTree</code>: best-supported phylogeny</li> <li><code>_bipartitions</code>: best tree with bootstrap results on nodes</li> <li><code>_bipartitionsBranchLabels</code>: best tree with bootstrap results on branches</li> <li><code>_bootstrap</code>: tree from each bootstrap sample</li> <li><code>_info</code>: information on the analysis performed</li> </ul> <p></p> <p>Now we will visualise the results: the phylogenetic tree. Open the \u201cbipartitions\u201d file (<code>RAxML_bipartitions.10000at7041</code>) and copy the contents (the newick-format tree).</p> <p>In your browser go to the iTOL Interactive Tree Of Life website and open the <code>Upload</code> page from the main navigation bar.</p> <p>Enter a <code>Tree name</code>, e.g. <code>tree1</code>. Paste the RAxML result bipartitions tree into the <code>Tree text:</code> box. Click <code>Upload</code> to load your tree onto the iTOL platform.</p> <p>By default, your tree should be displayed similarly to this one:</p> <p>Use the <code>Control Panel</code> on the right of the tree to select the <code>Advanced</code> tab and choose to display <code>Bootstraps</code> as <code>Text</code>.</p> <p>If you did not manage to visualise the tree</p> <p>You can find it on Gitpod at <code>/workspace/biodivinfo/data/Session2/tree_10000at7041.jpg</code>. Or you can directly see it here.</p> <p>Questions:</p> <ul> <li>Why would some nodes obtain 100% bootstrap support while others are weaker and others are very low indeed?</li> <li>How can we know if our \u201cspecies tree\u201d, made from just one single-copy orthologous group, reflects the reality of these species\u2019 evolutionary relationships?</li> <li>What would we need to do next in order to improve the confidence in our molecular \u201cspecies phylogeny\u201d?</li> </ul> Answer <ul> <li>Some nodes are very stable and do not change during bootstrap while others do. These weakers nodes indicate that the branching varies and may not be an accurate representation of the species tree</li> <li>We can compare the tree with what is known in the literature. Alternatively, we can compare this tree with species tree made from other single-copy orthologous groups. If all the trees concur, this is a very strong indicator of the species\u2019 evolutionary relationships</li> <li>Create trees from other single-copy orthologous groups and reconcile them with a tree from the literature if it exists.</li> </ul>"},{"location":"course_material/day2/5_reconciliation/","title":"Gene-Tree-Species-Tree Reconciliation","text":""},{"location":"course_material/day2/5_reconciliation/#aim","title":"Aim","text":"<p>Convert the molecular species phylogeny into an ultrametric time-calibrated species tree and use this for gene-tree-species-tree reconciliation.</p>"},{"location":"course_material/day2/5_reconciliation/#learning-outcomes","title":"Learning outcomes","text":"<ul> <li>What is the difference between a molecular and a time-calibrated phylogeny?</li> <li>What are gene-tree-species-tree reconciliation algorithms trying to achieve and how?</li> </ul>"},{"location":"course_material/day2/5_reconciliation/#building-an-ultrametric-time-calibrated-species-tree","title":"Building an ultrametric time-calibrated species tree","text":"<p>There are several tools available for converting molecular phylogenies to ultrametric time-calibrated trees. They usually require as input your molecular phylogeny as well as calibration points (estimates usually from fossils about the ranges of likely divergence times) for one or more nodes on the tree. We will use the chronos function of the ape package in R.</p> <p>Before we explore the tree, let\u2019s create a working directory for this exercise, starting by opening a terminal on the Workspace if you\u2019ve not already got one open. Then, from the <code>/workspace/biodivinfo/</code> directory, create a new directory (<code>mkdir</code>) and navigate into the new directory (<code>cd</code>):</p> <pre><code>cd /workspace/biodivinfo/\nmkdir Session3\ncd Session3/\n</code></pre> <p>Using the same set of 15 beetle species, but now applying the concatenation approach to be able to use alignments from 1\u2018000 single-copy orthologous groups:</p> <ul> <li>Aligned each orthogroup</li> <li>Filtered/trimmed each orthogroup</li> <li>Concatenated the trimmed alignments into a superalignment</li> <li>Used RAxML to compute, with bootstraps, the molecular species phylogeny</li> </ul> <p>This took several hours to run, therefore we are not going to try this in the class. Instead, the results are provided for you here and also pasted below, where the tree has been rooted based on the known outgroup species (<code>7054_0</code> &amp; <code>224129_0</code>) and where internal labels and species names have been added to make it easier to interpret and compare with the current understanding of beetle phylogeny.</p> <p>Here is the molecular species tree in Newick format: <pre><code>((((((((50390_0_Diabrotica_virgifera:0.15666,7539_0_Leptinotarsa_decemlineata:0.15804)100:0.05974,217634_0_Anoplophora_glabripennis:0.11339)Chrysomeloidea[100]:0.04091,(7048_0_Sitophilus_oryzae:0.12494,77166_0_Dendroctonus_ponderosae:0.13601)Curculionoidea[100]:0.13858)100:0.02727,116153_0_Aethina_tumida:0.24260)100:0.03487,(115357_0_Harmonia_axyridis:0.06618,41139_0_Coccinella_septempunctata:0.07128)Coccinelloidea[100]:0.17882)88:0.01976,(41895_0_Tribolium_madens:0.02321,7070_0_Tribolium_castaneum:0.02060)Tenebrionoidea[100]:0.28640)100:0.09637,(110193_0_Nicrophorus_vespilloides:0.33251,(1629725_0_Oryctes_borbonicus:0.22252,166361_0_Onthophagus_taurus:0.24064)Scarabaeoidea[100]:0.07437)100:0.05341):0.00483,(224129_0_Agrilus_planipennis:0.31846,7054_0_Photinus_pyralis:0.29250):0.09174)100;\n</code></pre></p> <p>Newick format - Wikipedia</p> <ul> <li>Parentheses indicate hierarchical relationships amongst species</li> <li>Branches can be labelled with bootstrap values, e.g. 100</li> <li>Branches can also be labelled with names, e.g. Tenebrionoidea</li> <li>Notice the semicolon at the end of the tree - it is often forgotten but most tools won\u2019t recognize a file as Newick format if it\u2019s missing!</li> </ul> <p>You can also copy the file from the provided data folder: <pre><code>cp /workspace/biodivinfo/data/Session3/Step1/OGs-1000-moltree-names-rooted.tre .\n</code></pre></p> <p>Now to visualise the tree we will, as before, copy and paste this molecular species phylogeny to upload it to iTOL.</p> <p>Use the iTOL <code>Advanced Control Panel</code> to turn on <code>Display</code> of <code>Node IDs</code> and turn on <code>Display</code> as <code>Text</code> the <code>Bootstraps</code>.</p> <p>Notice that now there is only one node that did not converge to 100% bootstrap support - regarding the placement of the groups of Tenebrionoidea &amp; Coccinelloidea.</p> <p>If you did not manage to visualise the tree</p> <p>You can find it on Gitpod at <code>/workspace/biodivinfo/data/Session3/Step1/tree_1000_OGs.jpg</code>. Or you can directly see it here.</p> <p>We now need to compare our tree to the literature to see if it is in agreement with the current thinking regarding the relations amongst beetle lineages.</p> <p>For comparison with the latest beetle phylogeny from the literature (see below):</p> <p>You should be able to find the internal node labels, provided for you on the tree you have just uploaded on iToL:</p> <p>Question: Does our 1\u2018000-orthogroup molecular species phylogeny agree with the current understanding of species relationships (see phylogeny below)?</p> Answer <p>Yes! Remember you can invert two branches of a node to facilitate the comparison between the two trees!</p> Recent reference on Coleoptera phylogeny: Integrated phylogenomics and fossil data illuminate the evolution of beetles, Cai et al. 2022  <p>Note</p> <p>Link to Cai et al. 2022.</p> <p>We can now convert our molecular phylogeny to an ultrametric time-calibrated tree using the <code>chronos</code> function of the <code>ape</code> package.</p> <p>Chronos: Molecular Dating by Penalised Likelihood and Maximum Likelihood</p> <ul> <li><code>chronos</code> is the main function fitting a chronogram to a phylogenetic tree whose branch lengths are in number of substitution per sites</li> <li><code>makeChronosCalib</code> is a tool to prepare data frames with the calibration points of the phylogenetic tree</li> </ul> <p>We could provide multiple calibration points to smooth the tree, but for today we will just find an estimate for the root age and use that as the only calibration point. We can use TimeTree.org to find a divergence estimate for any two beetle species in our collection that span the root of our tree, e.g. the age of the last common ancestor of Agrilus planipennis and Leptinotarsa decemlineata.</p> <p>TimeTree provides us with an \u201cAdjusted Time\u201d for the pairwise divergence time for Agrilus Planipennis and Leptinotarsa Decemlineata of 256 Million Years Ago (MYA).</p> <p>The R code for running chronos is provided here: <pre><code># Converting a molecular species phylogeny into a time-calibrated species tree\n# If you do not have 'ape' you will need to install it: install.packages(\"ape\")\n\n# Load ape package\nlibrary(ape)\n\n# Read in the molecular phylogeny\n# Make sure you are working in the same directory as the tree file\nmoltree&lt;-read.tree(\"OGs-1000-moltree-names-rooted.tre\")\n\n# Provide root calibration age of 256 million years\ncalib&lt;-makeChronosCalib(moltree, node=\"root\", age.min=256)\n\n# use the chronos function to convert the tree with the age constraint\ntimtree&lt;-chronos(moltree, calibration=calib, lambda=1, model=\"discrete\", control=chronos.control(nb.rate.cat=1))\n\n# check that the result is indeed ultrametric\nis.ultrametric(timtree)\nwrite.tree(timtree, file=\"Coleoptera_TimeTree.tre\")\n</code></pre></p> <p>Or you can fetch the R script with: <pre><code>cp /workspace/biodivinfo/scripts/MolecularTree_to_TimeTree.R .\n</code></pre></p> If you want to run the script automaticallyIf you want to run the successive steps manually <pre><code>Rscript MolecularTree_to_TimeTree.R\n</code></pre> <ul> <li>Launch R: <code>R</code></li> <li>Now for actually running chronos\u2026 first you need to load the library <code>ape</code>: <code>library(\"ape\")</code></li> <li>Then you can copy the R code provided above or from the provided R script file (<code>MolecularTree_to_TimeTree.R</code>) and enter return to execute the code<ul> <li><code>read.tree</code>: read in your molecular phylogeny file</li> <li><code>makeChronosCalib</code>: set the minimum age of the root of your tree</li> <li><code>chronos</code>: smooth conversion of the \u2018moltree\u2019 to the \u2018timetree\u2019</li> <li><code>write.tree</code>: write the resulting timetree to a file (<code>Coleoptera_TimeTree.tre</code>)</li> </ul> </li> <li>To exit R simply type <code>q()</code> and then return</li> <li>No need to save your workspace image: <code>Save workspace image? [y/n/c]: n</code></li> </ul> <p>Now let\u2019s open the tree file produced by chronos (<code>Coleoptera_TimeTree.tre</code>) and use iTOL to view it (as before), you can find the file in the EXPLORER menu under Session3, copy the Newick formatted tree and go to iTOL to upload it.</p> <p>The default view looks something like this, so we can use the <code>Advanced Control Panel</code> to change the views and thereby make comparisons with the literature tree easier.</p> <p></p> <p>Use the <code>Advanced Control Panel</code> to display the tree scale in inverted direction:</p> <ul> <li><code>Internal tree scale</code><ul> <li><code>Display</code></li> <li><code>Inverted scale</code>: <code>Yes</code></li> </ul> </li> <li>Use the \u201cFit to screen\u201d button <code>[]</code> to resize your tree in the viewer</li> </ul> <p>Note how the Tree scale - measured in millions of years - goes all the way back to 256, which is the minimum root age we applied as a constraint when using chronos to build the time tree from the molecular tree.</p> <p>If you did not manage to visualise the tree</p> <p>You can find it on Gitpod at <code>/workspace/biodivinfo/data/Session3/Step1/tree_time_calibrated.jpg</code>. Or you can directly see it here.</p> <p>Question: What are the main differences between the ultrametric time-calibrated tree shown above and our input molecular phylogeny copied again here below for comparison?</p> Answer <p>The branch lengths changed because the scale unit changed: this tree is expressed in time, while the previous one was expressed in substitutions/site. As a consequence, all the branches now have the same length, which is expected because all the species had the same span of time to evolve from their last common ancestor (i.e. the root of the tree).</p> <p>Questions:</p> <ul> <li>So what does \u2018ultrametric\u2019 mean in the context of phylogenetic trees?</li> <li>What might ultrametric trees be particularly useful for in terms of analyses?</li> </ul> Answer <ul> <li>An ultrametric tree is a rooted tree with edge lengths where all leaves are equidistant from the root. Here, it depicts times of divergence and as such can also be called a \u2018chronogram\u2019</li> <li>Ultrametric trees can be useful to relate evolution events (appearance of a species, for example) with other events (drastic and brutal changes in climate, adaptation to new life conditions\u2026)</li> </ul>"},{"location":"course_material/day2/5_reconciliation/#building-a-tree-for-a-dynamic-gene-family","title":"Building a tree for a dynamic gene family","text":"<p>We will now follow the same steps that we did to compute a tree for a universal single-copy orthologous group in Session II, but this time selecting instead an orthologous group that has some species with more than one gene copy and some species missing an orthologue.</p> <p>Note</p> <p>Remember that of the 14\u2018753 Coleoptera-level orthologous groups, only 1\u2018225 were showing single-copy orthologues in all 15 species. This means that the majority of orthologous groups show some level of dynamism in terms of gene gains and losses across this set of 15 beetle species.</p> <p>Browsing OrthoDB I found an example orthologous group where some species have more than one copy and one species is lacking an orthologue: https://www.orthodb.org/?level=7041&amp;species=7041&amp;query=10261at7041.</p> <p>It contains a total of 19 genes from 14 of the 15 Coleoptera species.</p> <ul> <li>10 species = single-copy (i.e. no gene duplications)</li> <li>4 species = multi-copy (i.e. gene duplications)</li> </ul> <p>Collect the input sequences: <pre><code>curl -o 10261at7041.fasta \"https://data.orthodb.org/v11/fasta?id=10261at7041&amp;species=7041\"\n</code></pre></p> <p>Replace the colon \u201c_0:\u201d in the protein identifiers with an underscore \u201c_0_\u201c: <pre><code>sed -i 's/_0:/_0_/g' 10261at7041.fasta\n</code></pre></p> <p>If it failed, fetch the fasta file from the data files folder</p> <pre><code>cp /workspace/biodivinfo/data/Session3/Step2/10261at7041.fasta .\n</code></pre> <p>Align the protein sequences - using MAFFT like before: <pre><code>mafft --quiet --auto 10261at7041.fasta &gt; 10261at7041.aln.fasta\n</code></pre></p> <p>Filter/trim the alignment using TrimAl like before: <pre><code>trimal -in 10261at7041.aln.fasta -out 10261at7041.aln.trm.fasta -automated1 -htmlout 10261at7041.aln.trm.html\n</code></pre></p> <p>Build the gene tree using RAxML like before: <pre><code>raxmlHPC-SSE3 -s 10261at7041.aln.trm.fasta -f a -N 10 -p 12345 -x 12345 -m PROTGAMMAJTT -n 10261at7041\n</code></pre></p> <p>Hint</p> <p>Note that RAxML is warning us that there are two pairs of sequences that are exactly identical and that these would normally be excluded from the analysis.</p> <p>While RAxML is running you can download and view the trimmed alignment file (the HTML version) like we did before, to check out these identical sequences:</p> <p>Note</p> <p>If you could not download it, you can view the alignment here.</p> <ul> <li>Sequences <code>115357_0_00054b</code> and <code>115357_0_000a81</code> are exactly identical (pink)<ul> <li>Two proteins from Harmonia axyridis</li> </ul> </li> <li>Sequences <code>7048_0_00018b</code> and <code>7048_0_0001a0</code> are exactly identical (orange)<ul> <li>Two proteins from Sitophilus oryzae</li> </ul> </li> </ul> <p>Note</p> <p>These proteins are not exactly identical along their entire lengths, but they are identical along the regions selected by TrimAl to use for phylogeny reconstruction. RAxML takes just one of any set of identical proteins to use for the phylogeny reconstruction and then adds back to the final tree any exact duplicates.</p> <p>Question: Why might there be some identical or near-identical protein sequences in the genomes of some species, i.e. what does it suggest about the evolution of these genes?</p> Answer <p>These genes probably underwent a duplication very recently. Only a short span of time passed since the duplication, which explains why they are onlly a few differences between the protein sequences.</p> <p>If these steps failed, you can fetch the results files from the data folder instead</p> <pre><code>cp /workspace/biodivinfo/data/Session3/Step2/10261at7041.aln.fasta .\ncp /workspace/biodivinfo/data/Session3/Step2/10261at7041.aln.trm.fasta .\ncp /workspace/biodivinfo/data/Session3/Step2/10261at7041.aln.trm.html .\ncp /workspace/biodivinfo/data/Session3/Step2/RAxML_info.10261at7041 .\ncp /workspace/biodivinfo/data/Session3/Step2/RAxML_bootstrap.10261at7041 .\ncp /workspace/biodivinfo/data/Session3/Step2/RAxML_bipartitions.10261at7041 .\ncp /workspace/biodivinfo/data/Session3/Step2/RAxML_bestTree.10261at7041 .\n</code></pre> <p>When RAxML is finished you should have a message on the terminal that looks something like the following:</p> <p>Now we open and view the resulting gene tree with bootstrapping support values (<code>RAxML_bipartitions.10261at7041</code>) using iTOL (as before).</p> <p>Hint</p> <p>Note the two pairs of \u201cidentical\u201d proteins that RAxML warned us about earlier:</p> <p> </p> <p>To make this gene tree more visually comparable to the species tree, let\u2019s start by properly rooting the tree according to where the known outgroup species (<code>7054_0</code> &amp; <code>224129_0</code>) branch off from the rest of the species (circled in pink):</p> <p>We can use iTOL to interactively reroot the gene tree knowing the outgroup species. Click on the branch circled in pink shown above, hover over Tree structure, and then select <code>Re-root the tree here</code>.</p> <p>In the re-rooted tree the outgroup species (blue) are now clearly placed to define the root of this phylogeny:</p> <p>If you did not manage to visualise the tree</p> <p>You can find it on Gitpod at <code>/workspace/biodivinfo/data/Session3/Step2/tree_dynamic_family_rerooted.jpg</code>. Or you can directly see it here.</p> <p>Question: Can you manually (just by eye) identify where all speciation nodes, duplication nodes, and loss events have occurred based on this gene tree?</p> <p>Hint</p> <p>When the identifiers start with the same numbers it means the genes are from the same species, e.g. species <code>7048_0</code> has three orthologues in this family.</p> Answer <p>As mentioned previously, there was 2 duplication events (3 genes) within species <code>7048_0</code>. 1 duplication (2 genes) event happened within species <code>115357_0</code>. 1 speciation and 1 duplication events (4 genes) happened within species <code>7070_0</code> and <code>41895_0</code>. However, it is very hard to guess where the loss event happened with just a gene tree. It would help to have more information about the species tree.</p>"},{"location":"course_material/day2/5_reconciliation/#reconciling-the-gene-and-species-trees","title":"Reconciling the gene and species trees","text":"<p>Now we will try to see if an algorithm specifically designed to identify where all speciation nodes, duplication nodes, and loss events have occurred on a gene tree given a species tree agrees or disagrees with your manual assessments.</p> <p>The main input requirements for <code>treerecs</code> are:</p> <ul> <li>A species phylogeny of all species: this can have more species than the gene tree but all species in the gene tree must be present in the species tree<ul> <li>We have the ultrametric time-calibrated species tree we made earlier: <code>Coleoptera_TimeTree.tre</code></li> <li>If you don\u2019t you can fetch it from the data folder: <pre><code>cp /workspace/biodivinfo/data/Session3/Step1/Coleoptera_TimeTree.tre .\n</code></pre></li> </ul> </li> <li>A gene tree: this can have fewer species than the species tree (due to losses) and it can have more than one gene per species (due to duplications)<ul> <li>We have the molecular gene family tree we made earlier: <code>RAxML_bipartitions.10261at7041</code></li> <li>If you don\u2019t you can fetch it from the data folder: <pre><code>cp /workspace/biodivinfo/data/Session3/Step2/RAxML_bipartitions.10261at7041 .\n</code></pre></li> </ul> </li> <li> <p>A mapping file indicating which genes belong to which species: <code>treerecs</code> can try to do this by matching identifiers but it is advisable to provide a map</p> <ul> <li>This we made manually, you can fetch it from the data folder: <pre><code>cp /workspace/biodivinfo/data/Session3/Step3/gene2species_map.txt .\n</code></pre></li> <li>This file simply lists the genes (green) and the species (blue) they belong to, so that <code>treerecs</code> knows which genes come from which species</li> </ul> <p> </p> </li> </ul> <p>Start by checking out what <code>treerecs</code> needs as command-line options, input, and output names etc. in order to perform a gene-tree-species-tree reconciliation: <code>treerecs -h</code>.</p> <p>The main input that <code>treerecs</code> needs:</p> <ul> <li><code>-g</code>, <code>--genetree GENETREE_FILE</code></li> <li><code>-s</code>, <code>--speciestree SPECIESTREE_FILE</code></li> <li><code>-S</code>, <code>--smap SMAP_FILE</code></li> <li>We will also ask it to: <code>-r</code>, <code>--reroot</code>: find the best root according to the reconciliation cost</li> <li>We will ask it to produce both Newick and an image (.svg) output</li> <li>And we will ask it to: <code>-f</code>, <code>--force</code>: force possible overwrite of existing files</li> </ul> <p>Putting them all together we have the following: <pre><code>treerecs -g RAxML_bipartitions.10261at7041 -s Coleoptera_TimeTree.tre -S gene2species_map.txt -r -O newick:svg -f\n</code></pre></p> <p>This will create a folder called <code>treerecs_output</code>. The <code>.svg</code> output file can now be downloaded and viewed e.g. in a browser like Chrome. You can also click here to view it directly.</p> <p>If treerecs failed you can fetch the files from the data folder</p> <ul> <li>The <code>.svg</code> file: <pre><code>cp /workspace/biodivinfo/data/Session3/Step3/treerecs_output/RAxML_bipartitions.10261at7041_recs.svg .\n</code></pre></li> <li>The Newick file: <pre><code>cp /workspace/biodivinfo/data/Session3/Step3/treerecs_output/RAxML_bipartitions.10261at7041_recs.nwk .\n</code></pre></li> </ul> <p>Viewing the Newick file you will see that there is a header printed that provides the total \u201ccost\u201d and the number of predicted duplications and losses:</p> <p>Question: What is meant by the \u201ctotal cost\u201d of the reconciliation?</p> Answer <p>The total cost is the weighted sum of the cost of all the duplications and losses required to reconcile the two trees. Here, a duplication has a cost of 2 and a loss has a cost of 1 (5 * 2 + 4 * 1 = 14 = total cost).</p> <p>The <code>.svg</code> image shows these results visually, by mapping the inferred evolutionary events (duplications  and losses ) inside the species phylogeny: showing a total of 5 predicted duplications and 4 predicted losses.</p> <p><code>treerecs</code> symbols</p> <ul> <li>Duplication: </li> <li>Loss: </li> </ul> <p>Let\u2019s now compare this with the input gene tree (<code>RAxML_bipartitions.10261at7041</code> - this should still be open in your iTOL browser), we can use iTOL to:</p> <ul> <li><code>Basic</code>: invert the gene tree</li> <li><code>Basic</code>: ignore the branch lengths</li> <li><code>Advanced</code>: resize to be taller and narrower</li> </ul> <p>If you did not manage to visualise the tree</p> <p>You can find it on Gitpod at <code>/workspace/biodivinfo/data/Session3/Step2/tree_dynamic_family_inverted.jpg</code>. Or you can directly see it here.</p> <p>Question: Can you see the correspondence between the inferred events and the gene tree?</p> Answer <p>The correspondence appears quite clearly. However, it is easier to visualise with both trees side-by-side (see below).</p> <p>High-resolution version</p> <p>You can find a better version of the figure on Gitpod at <code>/workspace/biodivinfo/data/Session3/Step3/annotated_reconciliation.png</code>. Or you can directly see it here.</p> <p>The placement in the gene tree of the Tenebrionoidea (Tribolium castaneum &amp; Tribolium madens) as more early branching than the Coccinelloidea (Coccinella septempunctata &amp; Hamonia axyridis) is in conflict with the species tree. This means that reconciliation inferred 1 duplication in the common ancestor of Tenebrionoidea-Coccinelloidea (pink) followed by 3 losses to match the counts in the gene tree (green).</p> <p>Question: Do you think this is a reasonable mapping of events - given that the node in the gene tree corresponding to Tenebrionoidea-Coccinelloidea obtained only 50% support?</p> Answer <p>This is probably not a reasonable mapping of event. Uncertainty in the gene tree is causing the reconciliation to over-complicate the number of events needed to resolve the two trees.</p> <p>The good news is that <code>treerecs</code> can be asked to ignore weekly-supported nodes of a gene tree during the reconciliation process, setting a threshold e.g. of 55%:</p> <ul> <li>Achieved by adding the <code>-t 55</code> option</li> <li>We also give the output a name <code>-o treerecs_output2</code> so it does not overwrite our first attempt at reconciliation using default parameters <pre><code>treerecs -g RAxML_bipartitions.10261at7041 -s Coleoptera_TimeTree.tre -S gene2species_map.txt -r -O newick:svg -f -t 55 -o treerecs_output2\n</code></pre></li> </ul> <p>If treerecs failed you can fetch the files from the data folder</p> <ul> <li>The <code>.svg</code> file: <pre><code>cp /workspace/biodivinfo/data/Session3/Step3/treerecs_output2/RAxML_bipartitions.10261at7041_recs.svg .\n</code></pre></li> <li>The Newick file: <pre><code>cp /workspace/biodivinfo/data/Session3/Step3/treerecs_output2/RAxML_bipartitions.10261at7041_recs.nwk .\n</code></pre> When you download this new <code>.svg</code> make sure to change the name or it could overwrite the one you downloaded previously</li> </ul> <p> </p> <p>The result maps the inferred evolutionary events (duplications and losses) inside the species phylogeny: now 4 duplications and 1 loss</p> <ul> <li>3 duplications appear as recent species-specific gene duplications</li> <li>1 duplication appears in the ancestor of Tribolium castaneum &amp; Tribolium madens</li> </ul> <p>Questions:</p> <ul> <li>Do you think this is a more reasonable mapping of events?</li> <li>Why is the Tribolium duplication considered as an ancestral event and not two independent duplications, one in each species of Tribolium?</li> </ul> Answer <ul> <li>This mapping of events is more reasonable because it decreases the number of events required to explain the phylogeny. As such, it respects the principle of maximum parsimony</li> <li>For the same reason than previously: it is more likely to see 1 ancestral duplication event followed by 1 speciation event rather than 1 speciation event followed by 2 ancestral duplication events</li> </ul> <p>High-resolution version</p> <p>You can find a better version of the figure on Gitpod at <code>/workspace/biodivinfo/data/Session3/Step3/annotated_reconciliation2.png</code>. Or you can directly see it here.</p>"},{"location":"course_material/day2/6_reconstruction/","title":"Gene Family Ancestral State Reconstruction","text":""},{"location":"course_material/day2/6_reconstruction/#aim","title":"Aim","text":"<p>Estimate ancestral gene copy numbers given the species phylogeny and counts of orthologous genes present in extant species.</p>"},{"location":"course_material/day2/6_reconstruction/#learning-outcomes","title":"Learning outcomes","text":"<ul> <li>What is the difference between tree reconciliation and state reconstruction?</li> <li>What is gene family ancestral state reconstruction trying to achieve and how?</li> </ul>"},{"location":"course_material/day2/6_reconstruction/#using-orthologue-counts-to-estimate-ancestral-gene-content","title":"Using orthologue counts to estimate ancestral gene content","text":"<p>There are a huge range of tools designed for ancestral state reconstructions, you may for example have encountered the R package, phytools. Today we will use CAFE5, a tool specifically designed for working with gene count data to infer ancestral gene contents per gene family.</p> <p>Before we reconstruct the ancestral state gene content of our species of interest, let\u2019s create a working directory for this exercise, starting by opening a terminal on the Workspace if you\u2019ve not already got one open. Then, from the <code>/workspace/biodivinfo/</code> directory, create a new directory (<code>mkdir</code>) and navigate into the new directory (<code>cd</code>):</p> <pre><code>cd /workspace/biodivinfo/\nmkdir Session4\ncd Session4/\n</code></pre> <p>We will continue to work with the same dataset of orthologous groups delineated across 15 beetles from OrthoDB. The main input requirements for CAFE are:</p> <ul> <li>An ultrametric time-calibrated species tree<ul> <li>We have the ultrametric time-calibrated species tree we made earlier: <code>Coleoptera_TimeTree_IDs.tre</code></li> <li>This is a version with just the species identifiers not the names. You can fetch it from the data folder: <pre><code>cp /workspace/biodivinfo/data/Session4/Coleoptera_TimeTree_IDs.tre .\n</code></pre></li> </ul> </li> <li>A table of counts of orthologues per species<ul> <li>This table was obtained by downloading and parsing the full table of orthology data from OrthoDB to extract counts of genes per species for Coleoptera-level orthogroups, you can fetch these pre-processed data here: <pre><code>cp /workspace/biodivinfo/data/Session4/Coleoptera_OGs.tsv .\n</code></pre></li> <li> <p>The table contains rows of orthogroups (blue) with columns of species (green) and all the counts of orthologues per orthogroup per species</p> <ul> <li>For the class the full set of 14\u2018753 orthogroups has been first filtered to select only orthologous groups found in more than 90% of species (with no restriction on gene copy-number), leaving 6\u2018824 orthogroups. Note that the species names/identifiers must be the same as those we have in our ultrametric time-calibrated species phylogeny</li> </ul> <p> </p> </li> </ul> </li> </ul> <p>Start by checking out what <code>CAFE</code> needs as command-line options, input, and output names etc. in order to perform an ancestral state reconstruction:</p> <pre><code>cafe5 -h\n</code></pre> <p>The main input that CAFE needs:</p> <ul> <li><code>-i</code>, <code>--infile</code>: path to tab delimited gene families file to be analysed</li> <li><code>-t</code>, <code>--tree</code>: path to file containing Newick formatted tree</li> </ul> <p>Putting this all together we have the following: <pre><code>cafe5 -i Coleoptera_OGs.tsv -t Coleoptera_TimeTree_IDs.tre\n</code></pre></p> <p>CAFE uses a birth and death process to model gene gain and loss across a user-specified phylogenetic tree. The distribution of family sizes generated under this model provides a basis for assessing the significance of the observed family size differences among taxa. Estimating Lambda (the traditional running of CAFE) performs a maximum likelihood calculation to estimate the most likely rate of change across the entire tree, given all the families and their counts</p> <p>For a typical CAFE analysis, users are most interested in determining two things:</p> <ul> <li>Which gene families/orthogroups are rapidly evolving?</li> <li>On which branches of the tree these families are rapidly evolving?</li> </ul> <p>By default, CAFE creates its outputs into a folder called \u201cresults\u201d: <pre><code>ls -l /workspace/biodivinfo/Session4/results\n</code></pre></p> <p>If CAFE failed, you can get the file from the folder with data files for the practical instead</p> <pre><code>cp -r /workspace/biodivinfo/data/Session4/results .\n</code></pre> <p>The <code>Base_asr.tre</code> output file contains all orthogroups with the ancestral gene counts mapped to the species tree. You might recognise the first tree as the orthogroup we used to build our first species tree (<code>10000at7041)</code>.</p> <p>We can get an overview of gains and losses across all families using a script provided by CAFE, <code>cafe5_draw_tree.py</code>: <pre><code>wget https://raw.githubusercontent.com/hahnlab/CAFE5/master/docs/tutorial/cafe5_draw_tree.py\n</code></pre></p> <p>You can also fetch the python script from the folder with data files for the practical</p> <pre><code>cp /workspace/biodivinfo/scripts/cafe5_draw_tree.py .\n</code></pre> <p>Start by checking out what are the script parameters: <pre><code>python cafe5_draw_tree.py -h\n</code></pre></p> <p>First we can plot the gains (Increase) across the tree: <pre><code>python cafe5_draw_tree.py -i results/Base_clade_results.txt -d results/Base_report.cafe -y Increase -o CAFE_gains_tree.png\n</code></pre></p> <p>And now we can plot the losses (Decrease) across the tree: <pre><code>python cafe5_draw_tree.py -i results/Base_clade_results.txt -d results/Base_report.cafe -y Decrease -o CAFE_losses_tree.png\n</code></pre></p> <p>The <code>.png</code> output files should be in your working directory, you can open them in Gitpod to view numbers of families showing gains or losses across the species tree.</p> <p>High-resolution version</p> <p>You can find a better version of the figure on Gitpod at <code>/workspace/biodivinfo/data/Session4/CAFE_gains_tree.png</code> and <code>/workspace/biodivinfo/data/Session4/CAFE_losses_tree.png</code>. Or you can also see them here: gains &amp; losses</p> <p>Questions:</p> <ul> <li>Which internal node shows the most gains?</li> <li>Which internal node shows the most losses?</li> </ul> Answer <ul> <li>The node between species <code>224129</code> and <code>7054</code> shows the most gains (230).</li> <li>The node between species <code>115357</code> and <code>7070</code> shows the most losses (116).</li> </ul> <p>A reminder of the species in our tree:</p>"},{"location":"course_material/day2/6_reconstruction/#comparing-ancestral-gene-content-estimates-with-reconciliation-results","title":"Comparing ancestral gene content estimates with reconciliation results","text":"<p>As a final step we can compare the results from our previous gene-tree-species-tree reconciliation of orthogroup <code>10261at7041</code> with those from gene family ancestral state reconstruction.</p> <p>Extract the gain-loss annotated tree for <code>10261at7041</code> from the CAFE results: <pre><code>grep 10261at7041 results/Base_asr.tre\n</code></pre></p> <p>Copy the output of the previous <code>grep</code> command (which is a Newick tree) and open it in iTOL as we did before - note that the Newick tree starts with the first open parenthesis and ends with the semicolon. Use the <code>Advanced Control Panel</code> to Display the Node IDs and view internal node annotations.</p> <p>Note</p> <p>You can also find the Newick file on gitpod at: <code>/workspace/biodivinfo/data/Session4/10261at7041_reconstruction.nwk</code></p> <p>If you did not manage to visualise the tree</p> <p>You can find it on Gitpod at <code>/workspace/biodivinfo/data/Session4/tree_10261at7041_CAFE.jpg</code>. Or you can directly see it here.</p> <p></p> <p>Terminal nodes (leaves) are labelled with the species (green), CAFE\u2019s own numbering of all nodes in the tree (yellow) and finally gene the copy number (pink). Nodes inside the tree are labelled with the internal CAFE numbering of all nodes in the tree (yellow) and the gene the copy number (pink).</p> <p>Nodes exhibiting significant changes from their ancestral states are indicated with an asterisk (*). We can now place our CAFE estimates next to our treerecs estimates to compare the results from the two approaches:</p> <p>Question: Do the ancestral state reconstructions results (<code>CAFE</code>) agree with the tree reconciliation events (<code>treerecs</code> - after asking it to ignore low-confidence nodes)?</p> Answer <p>Yes, they perfectly agree with each other!</p> <p></p>"},{"location":"course_material/day2/6_reconstruction/#congratulations-you-made-it-to-the-end","title":"Congratulations, you made it to the end!","text":""},{"location":"course_material/day3/1_general/","title":"General information and course material","text":""},{"location":"course_material/day3/1_general/#general-objectives","title":"General objectives","text":"<p>Understand the importance of gene and genome duplication in comparative genomics; understand the difficulty of comparing \u201cfunction\u201d between homologous genes, and know some tools to do so.</p>"},{"location":"course_material/day3/1_general/#course-material","title":"Course material","text":""},{"location":"course_material/day3/1_general/#lecture-1-function-in-model-vs-non-model-organisms","title":"Lecture 1: Function in model vs non-model organisms","text":"<p> Download the presentation</p> <p>Learning outcomes</p> <ul> <li>Notion of \u201cfunction\u201d for genes</li> <li>Sources of information on functions</li> <li>Annotation and biocuration</li> <li>Transfer and reliability of annotations in non-model species</li> </ul>"},{"location":"course_material/day3/1_general/#lecture-2-finding-information-about-gene-function-at-small-scale","title":"Lecture 2: Finding information about gene function at small scale","text":"<p> Download the presentation</p> <p>Learning outcomes</p> <ul> <li>Orthologue conjecture</li> <li>Functional enrichment</li> <li>Evolution of gene expression:<ul> <li>Gene expression as a quantitative trait</li> <li>Conservation among species (clustering per organ not per species)</li> <li>Fast evolution of testis genes</li> <li>Convergent evolution: venom glands</li> </ul> </li> </ul>"},{"location":"course_material/day3/1_general/#lecture-3-gene-and-genome-duplication","title":"Lecture 3: Gene and genome duplication","text":"<p> Download the presentation</p> <p>Learning outcomes</p> <ul> <li>Types of duplication: tandem, retroposition, whole genome</li> <li>Biased gene retention</li> <li>Evolution after duplication: sub- and neo-functionalisation</li> <li>Impact of duplication on biology:<ul> <li>Large gene family expansions</li> <li>Whole genome duplications in eukaryote evolution</li> </ul> </li> </ul>"},{"location":"course_material/day3/1_general/#course-gitlab-repository","title":"Course gitlab repository","text":"<p>The gitlab repository to run all the practicals is available at https://github.com/BgeeDB/Biodiversity-Bioinformatics.</p> <p>Note</p> <p>Remember to open a Gitpod workspace before starting the practicals. Click here for more information on Gitpod workspace.</p>"},{"location":"course_material/day3/1_general/#provided-data-files-and-scripts","title":"Provided data files and scripts","text":"<p>You can find the Exercise 3 datasets here and the R script to use in Exercise 2 here.</p>"},{"location":"course_material/day3/2_software/","title":"Software and R packages","text":""},{"location":"course_material/day3/2_software/#software","title":"Software","text":"<p>These links are provided for information only, they are not needed now for the practical but if you finish any exercises early you may want to investigate the tools/resources a little further by checking out their websites, user guides, and/or their main publications.</p> <p>BUSCO - Benchmarking Universal Single-Copy Orthologues</p> <ul> <li>Website</li> <li>Publication</li> <li>Userguide</li> </ul> <p>MAFFT - multiple sequence alignment tool</p> <ul> <li>Website</li> <li>Publication</li> <li>Userguide</li> </ul> <p>RAxML - maximum likelihood phylogenies</p> <ul> <li>Website</li> <li>Publication</li> <li>Userguide</li> </ul> <p>Treerecs - tree reconciliation software</p> <ul> <li>Website</li> <li>Publication</li> <li>Userguide</li> </ul> <p>TrimAl - alignment filtering tool</p> <ul> <li>Website</li> <li>Publication</li> <li>Userguide</li> </ul>"},{"location":"course_material/day3/2_software/#r-and-packages","title":"R and packages","text":"<p>R</p> <ul> <li>Website</li> <li>There are no publication for R itself but you should still cite it</li> <li>Userguide</li> </ul> <p>ape package</p> <ul> <li>Website</li> <li>Publication</li> <li>Userguide</li> </ul> <p>BgeeCall package</p> <ul> <li>Website</li> <li>There are no publication for the package itself but you should still cite it</li> <li>Userguide</li> </ul> <p>BgeeDB package</p> <ul> <li>Website</li> <li>Publication</li> <li>Userguide</li> </ul> <p>ggfortify package</p> <ul> <li>Website</li> <li>There are no publication for the package itself but you should still cite it</li> <li>Userguide</li> </ul>"},{"location":"course_material/day3/3_gene_function/","title":"Finding information on gene function at small scale","text":""},{"location":"course_material/day3/3_gene_function/#aim","title":"Aim","text":"<p>Use the gene <code>NCDN</code> as a case example and investigate how to know about a gene\u2019s function.</p>"},{"location":"course_material/day3/3_gene_function/#learning-outcomes","title":"Learning outcomes","text":"<ul> <li>What can we learn about <code>NCDN</code> function determination in Uniprot?</li> <li>What does <code>NCDN</code> Gene Onthology (GO) annotation tells us about its function?</li> <li>What can we deduce from <code>NCDN</code> gene expression in several species?</li> </ul>"},{"location":"course_material/day3/3_gene_function/#introduction","title":"Introduction","text":"<p>We will start the hands-on part of this course by focusing on a single gene as a case study. In this case, we will use the gene <code>NCDN</code> (neurochondrin).</p>"},{"location":"course_material/day3/3_gene_function/#check-about-ncdn-in-uniprot","title":"Check about <code>NCDN</code> in Uniprot","text":"<p>Go to Uniprot and find the human gene <code>NCDN</code> page (<code>NCDN_HUMAN</code>). There is a lot of information within a Uniprot\u2019s protein page; let\u2019s first focus on the function description.</p> <p>Hint</p> <p>Leave all the different species gene pages open in tabs. We will come back to them!</p> <p>Questions:</p> <ul> <li>What can we learn from the description of the human <code>NCDN</code>\u2019s function?</li> <li>How was this information annotated?</li> </ul> Answer <p>Now go to the mouse gene <code>NCDN</code> Uniprot page (<code>NCDN_MOUSE</code>).</p> <p>Questions:</p> <ul> <li>What can we learn from the description of the mouse <code>NCDN</code>\u2019s function?</li> <li>How was this information annotated?</li> </ul> Answer <p>Try it again with the bovin gene (<code>NCDN_BOVIN</code>), the drosophila gene page (<code>NCDN_DROME</code>) and the xenopus gene page (<code>NCDN_XENLA</code>).</p> <p>Questions:</p> <ul> <li>What can we learn about Uniprot\u2019s gene function assessment?</li> <li>In which species is most of the research on <code>NCDN</code> done?</li> </ul> Answer <p>Two other ways to shed light into a gene\u2019s function are checking its subcellular localization and its sequence features (domains, variants\u2026). We can find information on both of these aspects in Uniprot. First, focus on the subcellular location. There is one section dedicated to this in all Uniprot gene pages. Explore all the ones we opened before.</p> <p>Questions:</p> <ul> <li>Is <code>NCDN</code> subcellular location informative on its function?</li> <li>From where was each information retrieved?</li> </ul> Answer <p>Now try the same with the sequence features. There is a new <code>Feature viewer</code> in Uniprot gene pages. Explore it for all the species above.</p> <p>Questions:</p> <ul> <li>Is the <code>NCDN</code> sequence informative?</li> <li>Does it mean that retrieving information from a protein sequence is meaningless?</li> </ul> Answer"},{"location":"course_material/day3/3_gene_function/#learn-about-ncdns-gene-ontology-annotation","title":"Learn about <code>NCDN</code>\u2019s Gene Ontology annotation","text":"<p>Now, we will focus on <code>NCDN</code>\u2019s Gene Ontology (GO) annotation. There are many tools that use GO annotation in different ways. In this practical, we will use some of the most established ones.</p> <p>First, still in the Uniprot gene pages. Go to the GO annotation section on each page. Compare the GO terms in which <code>NCDN</code> is annotated in each species and the sources of such annotations.</p> <p>Question: What can we learn on GO annotations in non-model species?</p> <p>Go to the AmiGO 2 website, in the top menu, select <code>Search</code> and then <code>Genes and gene products</code>. Search for our <code>NCDN</code> gene.</p> <p>Questions:</p> <ul> <li>For which species do we have information? Why?</li> <li>How can we get GO annotations for other species?</li> </ul> Answer <p>Now you can go to each species AmiGO 2 <code>NCDN</code> pages. Explore them a bit.</p> <p>Question: From where do they retrieve the evidence for the GO annotations?</p> Answer"},{"location":"course_material/day3/3_gene_function/#look-at-expression-of-ncdn-for-several-species-in-bgee","title":"Look at expression of <code>NCDN</code> for several species in Bgee","text":"<p>We are now going to utilize the Bgee database in order to retrieve expression related information on our target gene (<code>NCDN</code>). You can access the webpage of Bgee in your browser by following this link.</p> <p>You will arrive at the Bgee homepage where you can access the various tools of Bgee in the top toolbar, directly search for a gene in the middle search box or download expression data for various animal species by clicking on the correct species picture in the bottom of the page. For this step, we will be interested in continuing to explore the function of <code>NCDN</code> orthologs, now focusing on their expression. To do this, you will just need to search for a gene name (<code>NCDN</code>), a UniProt or an Ensembl identifier.</p> <p>Doing this, you will be directed to the gene search result page where you can see that there are 49 genes in Bgee for the gene name <code>NCDN</code>.</p> <p>Question: Why are there multiple Ensembl identifiers for one gene name (<code>NCDN</code>)?</p> Answer <p>We can see that the gene names do not change (always <code>NCDN</code>), however there are multiple Ensembl identifiers because each one corresponds to the <code>NCDN</code> of a different species. Indeed, each Ensembl ID has prefixes identifying the species and feature type.</p> <p>In this page, you will notably find a column for <code>Gene identifier</code> that represents the unique Ensembl identifiers for each species or the species scientific and common name in the column <code>Organism</code>. To continue, please select a species (for example mouse) and click on their Ensembl ID (ENSMUSG00000028833). This will lead you to the mouse specific gene page for <code>NCDN</code>; don\u2019t worry you will still be able to see other orthologs of <code>NCDN</code>.</p> <p>On the left, you have the headers that allow you to jump easily to different sections of the page such as Expression or Orthologs. Since in this exercise we want to know where <code>NCDN</code> is expressed, we will primarily focus on the expression section for now.</p> <p>In this expression tab, you will find all anatomical entities where Bgee has evidence that this gene is expressed. You will notably find the expression score that denotes how strongly the gene was expressed in that tissue (from 0 to 100). If you want to verify the given information, you can also access the data used to determine expression in the link to source data column or see which type of data was used in source (such as R for bulk RNA-seq or A for Affymetrix microarray).</p> <p>Question: Looking at the top entries in the expression table, in which organ(s) do you think this gene is generally expressed?</p> Answer <p>We can see that the top three hits are CA3 field of hippocampus, CA3 field of hippocampus, perirhinal cortex. If we look at the next 10 hits, we also see that they are all tissues belonging to the brain. We can therefore suggest that this gene is expressed throughout the brain at really high levels (in the top 1% of most highly expressed genes in this region).</p> <p>We can also investigate if this gene is expressed at different stages of development. To do so, you can unselect <code>Anat. entity and cell types</code> and tick the <code>Dev. stage</code> box on top of the expression tab and update the results.</p> <p>Here, we see that this gene seems to be expressed in late adults as well as the embryonic stage (for example, <code>Theiler stage 04</code>). If you are unsure what a developmental stage term means, clicking on the identifier (e.g. <code>MmusDv:0000008</code>) will take you to the description of this term in the developmental ontology. Interestingly, in this case, looking at the <code>Reported absence of expression</code> section (below in the same page), we can see that there are no developmental stages where the gene is not expressed at all, even though its expression is much lower outside the brain.</p> <p>Questions:</p> <ul> <li>Go back to the <code>Expression</code> section and the <code>Anat. entity and cell types</code> filter. Where is <code>NCDN</code> the least expressed?</li> <li>Play around by combining the filters for sex, strain, developmental stage or anatomical entities, which insights can you gather?</li> </ul> Answer <ul> <li>We can see, for example, that <code>NCDN</code> has relatively low expression in renal tissue even though it is still expressed (expression score lower than 50)</li> <li>We can, for example, see that mouse strains C57BL/6 X CD-1 have a way lower expression overall of the <code>NCDN</code> gene than C57BL/6-Tyr c-Brd strains. We can also see that this gene is expressed throughout the life cycle of mice from embryonic stages to adulthood</li> </ul> <p>By clicking on the <code>Orthologs</code> section in the menu on the left or scrolling down to it, you can find the different orthologs for NCDN which are found in Bgee. This information is retrieved from the OMA SPARQL endpoint that you used on the first day. Orthologs for NCDN are found at 11 different taxon levels. You can see the Ensembl identifiers of orthologous genes at specific taxon levels by clicking the <code>See details</code> arrow.</p> <p>Question: Which is the higher taxon in which you can find human orthologs of mouse <code>NCDN</code>?</p> Answer <p>The Euarchontoglires taxon.</p> <p>Unfold the orthologs (<code>See details</code>) to find the human <code>NCDN</code>, and open its page in a new tab.</p> <p>Question: Does the function of <code>NCDN</code> seem to have been conserved between mouse and human? What about more distant species?</p> Answer <p>Looking at the <code>NCDN</code> gene in humans by finding it through the orthologs section, we can see that the <code>NCDN</code> gene is also highly expressed in the same tissues and at really similar levels of expression. We could therefore hypothesize that its function remained similar.</p> <p>Now we are going to compare the expression of the different orthologs of <code>NCDN</code> for Xenopus, Human, mouse, rat, guinea pig and macaque.</p> <p>First, gather the Ensembl identifiers for those genes by looking at the orthologs tab!</p> <ul> <li>Rat (<code>ENSRNOG00000011751</code>)</li> <li>Xenopus (<code>ENSXETG00000009669</code>)</li> <li>Human (<code>ENSG00000020129</code>)</li> <li>Mouse (<code>ENSMUSG00000028833</code>)</li> <li>Guinea pig (<code>ENSCPOG00000023962</code>)</li> <li>Macaque (<code>ENSMMUG00000019812</code>).</li> </ul> <p>We will learn to use Bgee expression comparison tool in order to gain novel insights on <code>NCDN</code> anatomical expression. To do this, click on the Analysis section of the top toolbar of Bgee and then on Expression comparison.</p> <p>Fill the orthologs identifiers in the gene list, with one gene per line and click the search button to launch Bgee\u2019s expression comparison tool.</p> <p>You will obtain the following results:</p> <p>Question: Looking at the max expression scores, do the results seem consistent with the anatomical localization of <code>NCDN</code> expression when looking at individual species?</p> Answer <p>Yes, the results are highly consistent, again we can see that <code>NCDN</code> expression is extremely highly expressed in the same tissues (mainly brain) throughout the given species.</p> <p>The conservation score represents the ratio between genes being called present in the tissue and the total number of genes. In our case since we only used orthologs, this value gives us the ratio between species which have <code>NCDN</code> expressed in that tissue divided by the total number of species for which we have data in that condition (maximum 6).</p> <p>Question: With the help of the conservation score, can you see for which species and tissue there is a qualitative difference in the expression of <code>NCDN</code>?</p> Answer <p>Yes, we can see that Xenopus tropicalis has lost expression of this gene in spleen and small intestine wherehas its expression remains relatively high in the other species.</p>"},{"location":"course_material/day3/4_group_function/","title":"Finding information about function of a group of genes","text":""},{"location":"course_material/day3/4_group_function/#aim","title":"Aim","text":"<p>Learn to explore the function of a set of genes as a group using GO enrichment, TopAnat and Bgee expression values.</p>"},{"location":"course_material/day3/4_group_function/#learning-outcomes","title":"Learning outcomes","text":"<ul> <li>What can a GO enrichment analysis tell us about the function of a set of genes of interest?</li> <li>What can TopAnat tell us about it?</li> <li>What can we learn on gene expression evolution by clustering expression values?</li> </ul>"},{"location":"course_material/day3/4_group_function/#go-enrichment","title":"GO enrichment","text":"<p>The first thing we can do to study the function of these genes as a set is a GO enrichment analysis. It will show us which GO terms are statistically over-represented in the list.</p> <p>We will do the GO enrichment species per species, for some species, and then we will be able to compare the results. In the file of our list of orthologs we have all the species Ensembl IDs. We will need to select only one species IDs at a time. To do so, download the file and open it in Excel or similar.</p> <p>Go to the PANTHER knowledgebase website.</p> <p>Let\u2019s start with human. Paste the complete list of human IDs in the box <code>Enter IDs</code>, select the species, <code>Statistical overrepresentation test</code> and <code>GO biological processes complete</code> as shown in the image below. Submit.</p> <p>Note</p> <p>The <code>Statistical overrepresentation test</code>, compares a test gene list to a reference gene list, and determines whether a particular GO term is overrepresented or not in this list. It is the GO enrichment that we have been referring to. The <code>Statistical enrichment test</code> option requires a list of genes with associated numerical values for each gene. It is also an enrichment analysis for another type of data, not the case we are doing here.</p> <p>Another page will appear asking which reference set of genes to use as the universe for the overrepresentation test. Select the human whole genome list of genes on the right panel as in the image.</p> <p>Then, another page will appear with a summary of what you just selected and asking for details on the statistical tests. Make sure the Fisher\u2019s exact test and the False Discovery Rate options are selected and launch the analysis.</p> <p>Great, we have done the GO enrichment analysis for the human genes in our list. Take a look at the results. The columns that give us the most information are the <code>Fold Enrichment</code> that quantifies how much a given GO term is overrepresented in the gene list, and the <code>Fdr (False Discovery Rate)</code> that will let us know if a given enrichment is statistically significant.</p> <p>Questions:</p> <ul> <li>What kind of GO terms do you see enriched?</li> <li>Is it what you expected?</li> </ul> Answer <p>Repeat the same analysis for the opossum and the chicken gene lists in new browser tabs. Keep the results of the human gene list open and compare them.</p> <p>Questions:</p> <ul> <li>Are the results consistent among species?</li> <li>How do annotations differ between species?</li> </ul> Answer"},{"location":"course_material/day3/4_group_function/#extra-question-if-time-permits","title":"Extra question if time permits","text":"<p>Do a GO enrichment analysis with the list of human genes but this time select the <code>GO molecular function complete</code> list of GO terms. Check the results.</p> <p>Questions:</p> <ul> <li>What has changed?</li> <li>Are these GO terms more meaningful for understanding the gene function?</li> </ul> Answer"},{"location":"course_material/day3/4_group_function/#tools-to-visually-represent-go-enrichment-results","title":"Tools to visually represent GO enrichment results","text":"<ul> <li>GO-Figure!<ul> <li>Publication</li> </ul> </li> <li>ReviGO<ul> <li>Publication</li> </ul> </li> </ul>"},{"location":"course_material/day3/4_group_function/#topanat","title":"TopAnat","text":"<p>To further investigate the function of the list of orthologous genes, we are now going to go back to Bgee website and use the TopAnat tool.</p> <p>TopAnat is an anatomical entity enrichment analysis tool based on the <code>topGO</code> R package. It is really similar in methodology to the GO enrichment that you just did but instead of using Gene Ontology terms, it is based on Anatomical entities or, in other words, on tissues or organs (more specifically, on Uberon identifiers). This tool will be able to tell us in which anatomical entities the genes in our set are being more expressed compared to a background set of genes.</p> <p>To access the tool in Bgee\u2019s website, please go to the top <code>Analysis</code> section of the top toolbar and click on <code>TopAnat: Expression enrichment analysis</code> (or just click on the red button <code>Expression enrichment analysis</code> on the homepage). Then, fill the gene list box with the list of human genes in our gene set list. We will not change the background genes for now, so you can directly press the <code>Submit your job</code> button after optionally putting your email address and a name to the job. The results may take a bit to appear.</p> <p>After a bit, you should get results in the following format at the bottom of the page:</p> <p>You can filter the result table based on any column by clicking on the column header (try it with <code>Fold Enrichment</code> or with <code>Fdr</code> in order to sort results from more significant to least significant).</p> <p>Questions</p> <ul> <li>In which anatomical entities do we have more expression than expected compared to the background genes?</li> <li>Why do you think there is a difference if we compare the results sorting by <code>Fold enrichment</code> or by <code>Fdr</code>?</li> </ul> Answer <ul> <li>We can see a strong enrichment of our list of genes compared to the whole human genes in gametes, oocytes, spermatocytes</li> <li>There can be big differences between the fold enrichment and the Fdr corrected p-value depending on how much data we had available to make the statistical significance tests and therefore the power we had to see any difference.</li> </ul> <p>You can open in another tab the results of the first (1) example case proposed by TopAnat (click on the number <code>1</code> next to <code>Examples</code> on the top of the page). <code>y</code>ou will see the kind of results you would get if you tested a gene list linked to the autism spectrum instead. You can always go back to the results from the last job by clicking on the <code>Recent jobs</code> button and then the name you gave to the job ID.</p> <p>Question: Do you think genes related to autism are more tissue specific than our list of one-to-one orthologs?</p> Answer <p>If we put genes related to autism on TopAnat (example 1 in the website), we can see that the fold enrichments are really high and the Fdr p-values are all extremely low for brain related tissues. Therefore, they seem to indeed be a bit more tissue specific.</p> <p>Try to do the same steps for other species such as Macaque or Opossum.</p> <p>Question: Do you get similar results? Do you get more similar results between species than when comparing with autism spectrum results?</p> Answer <p>Yes, we do get more similar results than when comparing with autism spectrum genes since the list is composed of genes for which we have orthologs in the different species and orthologs tend to have more similar tissue expression among each other than compared to random autism genes.</p>"},{"location":"course_material/day3/4_group_function/#clustering-of-homologous-organ-expression-in-several-species","title":"Clustering of homologous organ expression in several species","text":"<p>For this step, we are going to do a principal component analysis of the expression values for the multiple conditions and species. We will be using the <code>pca_dataset</code> found in the <code>/data</code> folder of Gitpod. In this dataset, each row represents the TPM value of a set of conditions (such as mouse, liver, male, adult) and each column represents a gene from the previously obtained orthologous gene list for the given species.</p> <p>To launch the analysis, you need to run the <code>pca_generation.R</code> script found in the <code>/scripts</code> folder using the following command:</p> <pre><code>Rscript pca_generation.R\n</code></pre> <p>Two figures will be generated in the <code>/figure</code> folder, one that colors the points based on species and one based on anatomical entities.</p> <p>For the first one colored by species, you obtain this graph:</p> <p>And here is the second one that is colored based on anatomical entities:</p> <p>Question: According to the PCA figures, is it the organs or the species that cluster more strongly together?</p> Answer <p>We can see that the clustering is much better when colored by organs than species, which is a result that is highly expected and seen in numerous studies.</p>"},{"location":"course_material/day3/5_duplicated_function/","title":"Function of duplicated genes","text":""},{"location":"course_material/day3/5_duplicated_function/#aim","title":"Aim","text":"<p>In this exercise, we will do something similar to what we did in the exercise 2 but for a quite different set of genes.</p>"},{"location":"course_material/day3/5_duplicated_function/#learning-outcome","title":"Learning outcome","text":"<p>Compare and understand the differences between different kinds of input data and the results.</p>"},{"location":"course_material/day3/5_duplicated_function/#exercise","title":"Exercise","text":"<p>We have used the OHNOLOGS database in which you can find lists of genes retained from different Whole Genome Duplications (WGD) in several vertebrate genomes. In this case, we have downloaded the list of zebrafish genes that were retained after the teleost-specific WGD (3R). Moreover, we have retrieved the orthologs of these zebrafish 3R retained genes in mouse. As mice are not teleosts, their genome hasn\u2019t duplicated genes resulting from the 3R WGD, but we can retrieve the ortholog genes of those that were retained in the 3R in zebrafish.</p> <p>In the <code>/data</code> folder of the Gitpod workspace, you can find two files: <code>Drerio3Rohnologs_7955.tsv</code>: zebrafish genes retained after the 3R <code>Drerio3Rohnologs_10090.tsv</code>: mouse orthologs of these genes</p> <p>Check the number of genes in each list. You can do this with: <pre><code>wc -l Drerio3Rohnologs_*\n</code></pre></p> <p>Questions:</p> <ul> <li>Why do you think they have a different number of genes?</li> <li>Why does the zebrafish file have roughly twice the number of genes in the mouse file?</li> <li>Why doesn\u2019t it have exactly twice as many genes?</li> </ul> Answer <p>Do a GO enrichment analysis with PANTHER of the zebrafish genes as we did in exercise 2.</p> <p>Questions:</p> <ul> <li>What kind of GO terms do we see enriched in this list?</li> <li>What does it tell us about the function of these genes?</li> <li>Is it different from what we found with the one-to-one orthologs list on exercise 2?</li> </ul> Answer <p>Do it again with the mouse orthologs.</p> <p>Question: Do we get similar results? Why?</p> Answer <p>To further explore the function of these genes, do a TopAnat for the zebrafish and the mouse lists.</p> <p>Questions:</p> <ul> <li>What kind of anatomical entities do we see enriched in the zebrafish TopAnat?</li> <li>Do they make sense given what we saw in the GO enrichment?</li> <li>What can we say about the function of this set of genes?</li> <li>Do we see the same in the mouse list? Why?</li> </ul> Answer <p>We arrived at the end of this course. Now, we would like to invite you to debate about what we just learned and about whatever question you may have. You can also ask us about specific questions related to your work if you are interested.</p>"}]}